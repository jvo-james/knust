<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Vendor Portal â”‚ YourMarket</title>
  <!-- Bootstrap 5 -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />
 <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
   <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Raleway:wght@400;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.5/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<style>
:root {
  --primary: #ff3860;
  --primary-dark: #e02e56;
  --secondary: #1e293b;
  --bg-light: #f0f2f5;
  --bg-card: #ffffff;
  --text-dark: #1f2937;
  --text-muted: #6b7280;
  --border-radius: .75rem;
  --transition-fast: .2s ease;
  --shadow-soft: 0 4px 20px rgba(0,0,0,0.05);
}

*,
*::before,
*::after {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}
body {
  font-family: 'Poppins', sans-serif;
  color: var(--text-dark);
  background: var(--bg-light);
  line-height: 1.6;
  -webkit-font-smoothing: antialiased;
}
a { text-decoration: none; color: inherit; }
img { display: block; max-width: 100%; }

.navbar {
  background: var(--bg-card) !important;
  box-shadow: var(--shadow-soft) !important;
  padding: 1rem 0;
  border-bottom-left-radius: var(--border-radius);
  border-bottom-right-radius: var(--border-radius);
}
.navbar-brand {
  font-size: 1.75rem;
  color: var(--primary) !important;
  transition: color var(--transition-fast);
}
.navbar-brand:hover { color: var(--primary-dark) !important; }
.navbar .nav-link {
  color: var(--text-muted);
  font-weight: 500;
  transition: color var(--transition-fast);
}
.navbar .nav-link:hover {
  color: var(--primary);
}

.card {
  background: var(--bg-card);
  border: none;
  border-radius: var(--border-radius);
  box-shadow: var(--shadow-soft);
  overflow: hidden;
}
.card .card-body {
  padding: 2rem;
}
.card-title {
  font-weight: 600;
  color: var(--secondary);
}
.input-group-text {
  background: var(--bg-light);
  border: 1px solid #d1d5db;
  border-right: none;
  border-radius: var(--border-radius) 0 0 var(--border-radius);
}
.form-control {
  border: 1px solid #d1d5db;
  border-radius: 0 var(--border-radius) var(--border-radius) 0;
  transition: border-color var(--transition-fast);
}
.form-control:focus {
  border-color: var(--primary);
  box-shadow: none;
}
.btn {
  border-radius: var(--border-radius);
  font-weight: 500;
  transition: background var(--transition-fast), transform var(--transition-fast);
}
.btn-danger {
  background: var(--primary);
  border: none;
}
.btn-danger:hover {
  background: var(--primary-dark);
  transform: translateY(-2px);
}
.btn-primary {
  background: var(--primary-dark);
  border: none;
}
.btn-primary:hover {
  background: var(--secondary);
  transform: translateY(-2px);
}
.text-center.text-muted a {
  color: var(--primary);
  transition: color var(--transition-fast);
}
.text-center.text-muted a:hover {
  color: var(--primary-dark);
}

#vendor-portal .row.g-4 .card {
  padding: 1.5rem 1rem;
  text-align: center;
}
#vendor-portal .row.g-4 i {
  font-size: 2rem;
}
#stat-products,
#stat-sales,
#stat-customers {
  font-size: 2rem;
  font-weight: 600;
  color: var(--primary);
}

#vendor-portal .card-header {
  background: var(--bg-card);
  border-bottom: 1px solid #e5e7eb;
  padding: 1rem 1.5rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
}
#vendor-portal .card-header h4 {
  font-weight: 600;
  color: var(--secondary);
}
#cancel-edit {
  font-size: .9rem;
}
#vendor-portal .card-body {
  padding: 1.5rem;
}
#product-form .form-label {
  font-weight: 500;
  color: var(--secondary);
}
#product-form .row.g-3 > div {
  position: relative;
}
#product-form input,
#product-form select,
#product-form textarea {
  border: 1px solid #d1d5db;
  border-radius: var(--border-radius);
  padding: .75rem 1rem;
  transition: border-color var(--transition-fast);
}
#product-form input:focus,
#product-form select:focus,
#product-form textarea:focus {
  border-color: var(--primary);
  outline: none;
}
#product-form textarea {
  resize: vertical;
}
#product-form h5 {
  margin-top: 1.5rem;
  margin-bottom: .5rem;
  font-weight: 600;
  color: var(--secondary);
}
#product-form .form-control[type="file"] {
  padding: .4rem;
}
#product-form .text-end button {
  padding: .75rem 2rem;
}

#gallery {
  margin-top: 1rem;
}
#gallery .card {
  border-radius: var(--border-radius);
  overflow: hidden;
  box-shadow: var(--shadow-soft);
  transition: transform var(--transition-fast), box-shadow var(--transition-fast);
}
#gallery .card:hover {
  transform: translateY(-4px);
  box-shadow: 0 6px 30px rgba(0,0,0,0.1);
}
#gallery .card-img-top {
  height: 200px;
  object-fit: cover;
}
#gallery .card-body {
  padding: 1rem;
  display: flex;
  flex-direction: column;
}
#gallery .card-title {
  font-size: 1.1rem;
  margin-bottom: .5rem;
  color: var(--secondary);
}
#gallery .text-danger {
  font-size: 1rem;
  font-weight: 600;
}
#gallery .text-muted {
  font-size: .9rem;
  margin-bottom: 1rem;
}
.gallery .btn {
  font-size: .85rem;
  padding: .5rem .75rem;
}

#search-input {
  max-width: 300px;
  border-radius: var(--border-radius);
  border: 1px solid #d1d5db;
  padding: .5rem 1rem;
  transition: border-color var(--transition-fast);
}
#search-input:focus {
  border-color: var(--primary);
  outline: none;
}

@media (max-width: 991px) {
  .navbar .navbar-collapse { text-align: center; }
  #search-input { max-width: 100%; margin-top: .5rem; }
}
@media (max-width: 575px) {
  #product-form .row.g-3 > div { width: 100%; }
  #vendor-portal .row.g-4 { row-gap: 1.5rem; }
}

</style>

</head>
<body>
  <!-- NAVBAR -->
  <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm">
    <div class="container">
      <a class="navbar-brand fw-bold text-danger" href="#">YourMarket Vendor</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navMenu">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navMenu">
        <ul class="navbar-nav ms-auto align-items-center">
          <li class="nav-item me-3">
            <a href="#" id="show-signup" class="nav-link"><i class="fas fa-user-plus"></i> Sign Up</a>
          </li>
          <li class="nav-item">
            <a href="#" id="show-signin" class="nav-link"><i class="fas fa-sign-in-alt"></i> Sign In</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <main class="container my-5">

    <!-- SIGN UP & SIGN IN FORMS -->
    <div id="auth-section" class="row justify-content-center">
      <!-- SIGN UP CARD -->
      <div id="signup-card" class="col-lg-5 mb-4">
        <div class="card shadow-sm">
          <div class="card-body">
            <h3 class="card-title mb-4 text-center"><i class="fas fa-user-plus text-danger"></i> Create Account</h3>
            <form id="signup-form">
              <div class="mb-3 input-group">
                <span class="input-group-text"><i class="fas fa-envelope"></i></span>
                <input type="email" id="signup-email" name="signup-email"
                       class="form-control" placeholder="Email address" required>
              </div>
              <div class="mb-3 input-group">
                <span class="input-group-text"><i class="fas fa-lock"></i></span>
                <input type="password" id="signup-pass" name="signup-pass"
                       class="form-control" placeholder="Password" required>
              </div>
              <div class="mb-4 input-group">
                <span class="input-group-text"><i class="fas fa-phone-alt"></i></span>
                <input type="tel" id="signup-phone" name="signup-phone"
                       class="form-control" placeholder="Mobile number" required>
              </div>
              <button type="submit" class="btn btn-danger w-100">
                <i class="fas fa-user-plus"></i> Sign Up
              </button>
            </form>
            <p class="mt-3 text-center text-muted">
              Already registered?
              <a href="#" id="to-signin">Sign In <i class="fas fa-sign-in-alt"></i></a>
            </p>
          </div>
        </div>
      </div>

      <!-- SIGN IN CARD -->
      <div id="signin-card" class="col-lg-5 mb-4 d-none">
        <div class="card shadow-sm">
          <div class="card-body">
            <h3 class="card-title mb-4 text-center"><i class="fas fa-sign-in-alt text-primary"></i> Sign In</h3>
            <form id="signin-form">
              <div class="mb-3 input-group">
                <span class="input-group-text"><i class="fas fa-envelope"></i></span>
                <input type="email" id="login-email" name="login-email"
                       class="form-control" placeholder="Email address" required>
              </div>
              <div class="mb-4 input-group">
                <span class="input-group-text"><i class="fas fa-lock"></i></span>
                <input type="password" id="login-pass" name="login-pass"
                       class="form-control" placeholder="Password" required>
              </div>
              <button type="submit" class="btn btn-primary w-100">
                <i class="fas fa-sign-in-alt"></i> Sign In
              </button>
            </form>
            <p class="mt-3 text-center text-muted">
              New vendor?
              <a href="#" id="to-signup">Create Account <i class="fas fa-user-plus"></i></a>
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- VENDOR DASHBOARD & PRODUCT FORM -->
    <div id="vendor-portal" class="d-none">

      <!-- DASHBOARD STATS -->
      <div class="row g-4 mb-5">
        <div class="col-md-4">
          <div class="card text-center shadow-sm py-4">
            <i class="fas fa-box-open fa-2x text-info mb-2"></i>
            <h5 class="mb-1">Products</h5>
            <p id="stat-products" class="h3">0</p>
          </div>
        </div>
        <div class="col-md-4">
          <div class="card text-center shadow-sm py-4">
            <i class="fas fa-dollar-sign fa-2x text-success mb-2"></i>
            <h5 class="mb-1">Sales</h5>
            <p id="stat-sales" class="h3">â‚µ0.00</p>
          </div>
        </div>
        <div class="col-md-4">
          <div class="card text-center shadow-sm py-4">
            <i class="fas fa-user-friends fa-2x text-warning mb-2"></i>
            <h5 class="mb-1">Customers</h5>
            <p id="stat-customers" class="h3">0</p>
          </div>
        </div>
      </div>

      <!-- PRODUCT UPLOAD / EDIT FORM -->
      <div class="card mb-5 shadow-sm">
        <div class="card-header bg-white d-flex justify-content-between align-items-center">
          <h4 class="mb-0"><i class="fas fa-plus-circle text-danger"></i> Add / Edit Product</h4>
          <button id="cancel-edit" class="btn btn-sm btn-outline-secondary d-none">
            <i class="fas fa-times"></i> Cancel Edit
          </button>
        </div>
        <div class="card-body">
          <form id="product-form" class="row g-3">
            <input type="hidden" id="prod-id">
            <div class="col-md-6">
              <label class="form-label"><i class="fas fa-tag"></i> Title</label>
              <input type="text" id="prod-title" class="form-control" placeholder="Product Name" required>
            </div>
            <div class="col-md-3">
              <label class="form-label"><i class="fas fa-money-bill-wave"></i> Price (GHS)</label>
              <input type="number" id="prod-price" class="form-control" step="0.01" required>
            </div>
            <div class="col-md-3">
              <label class="form-label"><i class="fas fa-layer-group"></i> Category</label>
              <select id="prod-category" class="form-select" required>
                <option value="">Selectâ€¦</option>
                <option>Fashion</option>
                <option>Electronics</option>
                <option>Beauty</option>
                <option>Books</option>
                <option>Shoes</option>
                <option>Home & Living</option>
              </select>
            </div>
            <div class="col-12">
              <label class="form-label"><i class="fas fa-info-circle"></i> Description</label>
              <textarea id="prod-desc" class="form-control" rows="3" placeholder="Detailed descriptionâ€¦" required></textarea>
            </div>
            <div class="col-md-4">
              <label class="form-label"><i class="fas fa-boxes"></i> Stock Quantity</label>
              <input type="number" id="prod-stock" class="form-control" min="0" value="1" required>
            </div>
            <div class="col-md-4">
              <label class="form-label"><i class="fas fa-barcode"></i> SKU / Code</label>
              <input type="text" id="prod-sku" class="form-control" placeholder="SKU or Product Code">
            </div>
            <div class="col-md-4">
              <label class="form-label"><i class="fas fa-image"></i> Upload Image</label>
              <input type="file" id="prod-image" class="form-control" accept="image/*" required>
            </div>

            <!-- PAYMENT RECEIVING METHOD -->
            <div class="col-12">
              <h5 class="mt-4"><i class="fas fa-wallet text-success"></i> Payment Methods</h5>
            </div>
            <div class="col-md-6">
              <label class="form-label"><i class="fas fa-mobile-alt"></i> Mobile Money Number</label>
              <input type="tel" id="pay-momo" class="form-control" placeholder="e.g. +233 24 000 0000">
            </div>
            <div class="col-md-6">
              <label class="form-label"><i class="fas fa-university"></i> Bank Account</label>
              <input type="text" id="pay-bank" class="form-control" placeholder="Bank & Account No.">
            </div>
            <div class="col-md-6">
              <label class="form-label"><i class="fab fa-paypal"></i> PayPal Email</label>
              <input type="email" id="pay-paypal" class="form-control" placeholder="paypal@example.com">
            </div>

            <div class="col-12 text-end">
              <button type="submit" class="btn btn-danger">
                <i class="fas fa-save"></i> Save Product
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- YOUR PRODUCTS GALLERY -->
      <div class="mb-4 d-flex justify-content-between align-items-center">
        <h4><i class="fas fa-th-list"></i> Your Products</h4>
        <input type="text" id="search-input" class="form-control w-25" placeholder="Searchâ€¦">
      </div>
      <div id="gallery" class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
        <!-- product cards injected here -->
      </div>
    </div>
  </main>
</body>
<script>
document.addEventListener('DOMContentLoaded', () => {
  // â”€â”€ Utilities â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const load = key => JSON.parse(localStorage.getItem(key) || '[]');
  const save = (key, val) => localStorage.setItem(key, JSON.stringify(val));
  const hash = str => btoa(str);

  // â”€â”€ Session & State â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const vendorsKey = 'vendors';
  const productsKey = 'products';

  let currentVendor = null;

  function loadVendors() {
    return load(vendorsKey);
  }
  function saveVendors(vs) {
    save(vendorsKey, vs);
  }
  function setCurrentVendor(v) {
    sessionStorage.setItem('currentVendorId', v.id);
    currentVendor = v;
  }
  function clearCurrentVendor() {
    sessionStorage.removeItem('currentVendorId');
    currentVendor = null;
  }
  function initCurrentVendor() {
    const vid = sessionStorage.getItem('currentVendorId');
    if (!vid) return null;
    const v = loadVendors().find(x => x.id == vid);
    if (v) currentVendor = v;
    return v;
  }

  // â”€â”€ UI Elements â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const signupCard    = document.getElementById('signup-card');
  const signinCard    = document.getElementById('signin-card');
  const authSection   = document.getElementById('auth-section');
  const portalSection = document.getElementById('vendor-portal');
  const toSigninLink  = document.getElementById('to-signin');
  const toSignupLink  = document.getElementById('to-signup');
  const showSignup    = document.getElementById('show-signup');
  const showSignin    = document.getElementById('show-signin');
  const signupForm    = document.getElementById('signup-form');
  const signinForm    = document.getElementById('signin-form');
  const logoutBtn     = document.getElementById('logout-btn');
  const statProducts  = document.getElementById('stat-products');
  const statSales     = document.getElementById('stat-sales');
  const statCustomers = document.getElementById('stat-customers');
  const prodForm      = document.getElementById('product-form');
  const cancelEditBtn = document.getElementById('cancel-edit');
  const galleryEl     = document.getElementById('gallery');
  const searchInput   = document.getElementById('search-input');

  // â”€â”€ Navigation between Sign Up / Sign In â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  function showSignupForm() {
    signupCard.classList.remove('d-none');
    signinCard.classList.add('d-none');
  }
  function showSigninForm() {
    signinCard.classList.remove('d-none');
    signupCard.classList.add('d-none');
  }
  showSignup.addEventListener('click', e => { e.preventDefault(); showSignupForm(); });
  showSignin.addEventListener('click', e => { e.preventDefault(); showSigninForm(); });
  toSigninLink.addEventListener('click', e => { e.preventDefault(); showSigninForm(); });
  toSignupLink.addEventListener('click', e => { e.preventDefault(); showSignupForm(); });

  // â”€â”€ Render / Hide Portal â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  function renderAuthUI() {
    if (currentVendor) {
      authSection.classList.add('d-none');
      portalSection.classList.remove('d-none');
      renderStats();
      renderGallery();
      loadVendorPaymentMethods();
    } else {
      authSection.classList.remove('d-none');
      portalSection.classList.add('d-none');
      showSignupForm();
    }
  }

  // â”€â”€ Sign Up â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  signupForm.addEventListener('submit', e => {
    e.preventDefault();
    const email = document.getElementById('signup-email').value.trim();
    const pass  = document.getElementById('signup-pass').value;
    const phone = document.getElementById('signup-phone').value.trim();
    let vs = loadVendors();
    if (vs.some(v => v.email === email)) {
      return alert('That email is already registered.');
    }
    const newVendor = {
      id: Date.now(),
      email,
      passwordHash: hash(pass),
      phone,
      paymentMethods: { momo:'', bank:'', paypal:'' }
    };
    vs.push(newVendor);
    saveVendors(vs);
    alert('Account created! Please sign in.');
    showSigninForm();
    signupForm.reset();
  });

  // â”€â”€ Sign In â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  signinForm.addEventListener('submit', e => {
    e.preventDefault();
    const email = document.getElementById('login-email').value.trim();
    const pass  = document.getElementById('login-pass').value;
    const vs = loadVendors();
    const vend = vs.find(v => v.email === email && v.passwordHash === hash(pass));
    if (!vend) return alert('Invalid credentials.');
    setCurrentVendor(vend);
    renderAuthUI();
    signinForm.reset();
  });

  logoutBtn.addEventListener('click', () => {
    clearCurrentVendor();
    renderAuthUI();
  });

  // â”€â”€ Stats â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  function renderStats() {
    const allProds = load(productsKey);
    const mine = allProds.filter(p => p.vendorName === currentVendor.email);
    statProducts.textContent = mine.length;
    // placeholder sales/customers
    statSales.textContent = 'â‚µ' + mine.reduce((sum,p)=> sum + parseFloat(p.price), 0).toFixed(2);
    statCustomers.textContent = mine.length; 
  }

  // â”€â”€ Payment Methods â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  function loadVendorPaymentMethods() {
    const pm = currentVendor.paymentMethods || {};
    document.getElementById('pay-momo').value   = pm.momo || '';
    document.getElementById('pay-bank').value   = pm.bank || '';
    document.getElementById('pay-paypal').value = pm.paypal || '';
  }
  function saveVendorPaymentMethods() {
    const vs = loadVendors();
    const idx = vs.findIndex(v => v.id === currentVendor.id);
    if (idx < 0) return;
    vs[idx].paymentMethods = {
      momo:   document.getElementById('pay-momo').value.trim(),
      bank:   document.getElementById('pay-bank').value.trim(),
      paypal: document.getElementById('pay-paypal').value.trim()
    };
    saveVendors(vs);
    currentVendor = vs[idx];
  }

  // â”€â”€ Product Form â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  let editingId = null;
  cancelEditBtn.addEventListener('click', e => {
    e.preventDefault();
    resetProductForm();
  });

  function resetProductForm() {
    editingId = null;
    prodForm.reset();
    document.getElementById('prod-id').value = '';
    cancelEditBtn.classList.add('d-none');
  }

  prodForm.addEventListener('submit', e => {
    e.preventDefault();
    if (!currentVendor) return alert('Please sign in.');

    // gather form values
    const id       = document.getElementById('prod-id').value || Date.now();
    const title    = document.getElementById('prod-title').value.trim();
    const price    = parseFloat(document.getElementById('prod-price').value).toFixed(2);
    const category = document.getElementById('prod-category').value;
    const desc     = document.getElementById('prod-desc').value.trim();
    const stock    = parseInt(document.getElementById('prod-stock').value);
    const sku      = document.getElementById('prod-sku').value.trim();
    const imgInput = document.getElementById('prod-image');
    const allProds = load(productsKey);

    // helper to save product record
    function upsertProduct(imageData) {
      saveVendorPaymentMethods();
      const base = {
        id, title, price, category, description: desc,
        stock, sku, imageUrl: imageData,
        vendorName: currentVendor.email
      };
      const idx = allProds.findIndex(p => p.id == id);
      if (idx > -1) allProds[idx] = base;
      else allProds.push(base);
      save(productsKey, allProds);
      resetProductForm();
      renderGallery();
      renderStats();
      alert('Product saved.');
    }

    // handle image file
    if (imgInput.files && imgInput.files[0]) {
      const reader = new FileReader();
      reader.onload = () => upsertProduct(reader.result);
      reader.readAsDataURL(imgInput.files[0]);
    } else {
      // editing without changing image
      const existing = allProds.find(p => p.id == id);
      upsertProduct(existing ? existing.imageUrl : '');
    }
  });

  // â”€â”€ Gallery â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  function renderGallery() {
    galleryEl.innerHTML = '';
    let prods = load(productsKey).filter(p => p.vendorName === currentVendor.email);
    // apply search filter
    const q = searchInput.value.trim().toLowerCase();
    if (q) prods = prods.filter(p => p.title.toLowerCase().includes(q));
    if (!prods.length) {
      galleryEl.innerHTML = '<p class="text-muted">No products yet.</p>';
      return;
    }
    prods.forEach(p => {
      const col = document.createElement('div');
      col.className = 'col';
      col.innerHTML = `
        <div class="card h-100 shadow-sm">
          <img src="${p.imageUrl}" class="card-img-top" alt="${p.title}">
          <div class="card-body d-flex flex-column">
            <h5 class="card-title">${p.title}</h5>
            <p class="mb-1 text-danger">â‚µ${p.price}</p>
            <p class="text-muted mb-2">${p.category}</p>
            <div class="mt-auto d-flex gap-2">
              <button class="btn btn-sm btn-outline-primary edit-btn"><i class="fas fa-edit"></i></button>
              <button class="btn btn-sm btn-outline-danger del-btn"><i class="fas fa-trash"></i></button>
            </div>
          </div>
        </div>`;
      // Edit
      col.querySelector('.edit-btn').onclick = () => {
        editingId = p.id;
        document.getElementById('prod-id').value       = p.id;
        document.getElementById('prod-title').value    = p.title;
        document.getElementById('prod-price').value    = p.price;
        document.getElementById('prod-category').value = p.category;
        document.getElementById('prod-desc').value     = p.description;
        document.getElementById('prod-stock').value    = p.stock;
        document.getElementById('prod-sku').value      = p.sku;
        cancelEditBtn.classList.remove('d-none');
        window.scrollTo({ top: 0, behavior: 'smooth' });
      };
      // Delete
      col.querySelector('.del-btn').onclick = () => {
        if (!confirm('Delete this product?')) return;
        const arr = load(productsKey).filter(x => x.id != p.id);
        save(productsKey, arr);
        renderGallery();
        renderStats();
      };
      galleryEl.appendChild(col);
    });
  }

  searchInput.addEventListener('input', renderGallery);

  // â”€â”€ Init â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  if (!localStorage.getItem(productsKey)) save(productsKey, []);
  initCurrentVendor();
  renderAuthUI();
});
</script>

</html>
