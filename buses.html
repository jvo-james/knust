<!DOCTYPE html>
<html lang="en" class="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <title>Vitra – KNUST Shuttle Tracker</title>

  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600;700&display=swap" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=Raleway:wght@400;700&display=swap" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.5/gsap.min.js"></script>

  <style>
   :root {
  --primary:   #006233;
  --secondary: #372d2f; 
  --accent:    #ffd700;
  --primary-dark: #0056b3;  
  --light-bg: #f5fcff;
  --white: #ffffff;
  --dark-text: #222222;
  --muted-text: #666666;
  --radius: 12px;
  --gap: 20px;
  --transition: 0.3s ease;
  --shadow-light: 0 4px 16px rgba(0, 0, 0, 0.1);
  --shadow-dark: 0 8px 24px rgba(0, 0, 0, 0.15);
  --font-sans: 'Poppins', sans-serif;
  --font-alt: 'Montserrat', sans-serif;
}

*,
*::before,
*::after {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  font-family: var(--font-sans);
  background: var(--light-bg);
  color: var(--dark-text);
  line-height: 1.6;
  overflow-x: hidden;
}

.app-header {
  position: sticky;
  top: 0;
  width: 100%;
  background: var(--secondary);
  color: var(--white);
  z-index: 1000;
  box-shadow: var(--shadow-light);
}
.header-inner {
  max-width: 1200px;
  margin: 0 auto;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 1rem var(--gap);
}
.logo {
  width: 50px;
  height: 50px;
}
.app-title {
  font-family: var(--font-alt);
  font-size: 1.8rem;
  font-weight: 700;
  display: flex;
  align-items: center;
}
.app-title i {
  margin-right: 0.5rem;
  color: var(--accent);
}
.header-nav {
  display: flex;
  align-items: center;
}
.nav-btn {
  background: none;
  border: none;
  color: var(--white);
  font-size: 1rem;
  margin-left: 1rem;
  padding: 0.5rem;
  cursor: pointer;
  transition: color var(--transition), background var(--transition);
  border-radius: var(--radius);
}
.nav-btn:hover,
.nav-btn.active {
  background: rgba(255,255,255,0.1);
  color: var(--accent);
}
.hamburger {
  display: none;
  background: none;
  border: none;
  color: var(--white);
  font-size: 1.8rem;
  cursor: pointer;
}
.mobile-sidebar {
  position: fixed;
  top: 0;
  left: -260px;
  width: 260px;
  height: 100%;
  background: var(--secondary);
  padding: 2rem 1rem;
  box-shadow: var(--shadow-dark);
  transition: left var(--transition);
  z-index: 1100;
}
.mobile-sidebar .close-sidebar {
  background: none;
  border: none;
  color: var(--white);
  font-size: 1.2rem;
  margin-bottom: 2rem;
  cursor: pointer;
}
.mobile-sidebar .nav-btn {
  display: block;
  width: 100%;
  text-align: left;
  margin-bottom: 1rem;
}


    .hero-section {
  position: relative;
  height: 80vh;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
}
.hero-background img {
  position: absolute;
  top: 0; left: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
  filter: brightness(0.6);
}
.hero-overlay {
  position: absolute;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background: rgba(0,0,0,0.3);
}
.hero-content {
  position: relative;
  text-align: center;
  color: var(--white);
  max-width: 800px;
  padding: 0 var(--gap);
}
.hero-title {
  font-family: var(--font-alt);
  font-size: 3rem;
  font-weight: 700;
  margin-bottom: 1rem;
  white-space: nowrap;
  overflow: hidden;
  border-right: 3px solid var(--accent);
}
.hero-subtitle {
  font-size: 1.25rem;
  margin-bottom: 2rem;
}
.hero-buttons button {
  margin: 0 0.5rem;
}
.bus-animations {
  position: absolute;
  bottom: 10%;
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  gap: 2rem;
}
.bus-animation {
  font-size: 2rem;
  opacity: 0.8;
}
@keyframes busMove {
  0% { transform: translateX(-100px) scale(0.8); opacity: 0; }
  50% { opacity: 1; }
  100% { transform: translateX(100px) scale(1); opacity: 0; }
}
.animate-bus {
  animation: busMove 4s var(--transition) infinite;
}
 .hero-section {
  perspective: 1000px;
 }
.hero-background img {
 transform: translateZ(-100px) scale(1.1);  }
    .bus-animation {
 transform-origin: center center;
 }

    .container {
  max-width: 1200px;
  margin: -10vh auto 2rem;
  padding: 0 var(--gap);
}
.section {
  margin: 4rem 0;
}
.section h2 {
  font-family: var(--font-alt);
  font-size: 1.6rem;
  margin-bottom: 1rem;
  display: flex;
  align-items: center;
  color: var(--secondary);
}
.section h2 i {
  margin-right: 0.5rem;
  color: var(--accent);
}


    .map-container {
  height: 350px;
  border-radius: var(--radius);
  overflow: hidden;
  margin-bottom: 1rem;
  box-shadow: var(--shadow-dark);
}
.live-table-container {
  overflow-x: auto;
}
.live-table {
  width: 100%;
  border-collapse: collapse;
  box-shadow: var(--shadow-light);
}
.live-table th,
.live-table td {
  padding: 0.75rem 1rem;
  text-align: left;
}
.live-table th {
  background: var(--secondary);
  color: var(--white);
  position: sticky;
  top: 0;
}
.live-table tr:nth-child(even) {
  background: #fafafa;
}
.live-table td {
  border-bottom: 1px solid #eee;
}

    .booking-section form {
  background: var(--white);
  padding: 2rem;
  border-radius: var(--radius);
  box-shadow: var(--shadow-light);
}
.form-row {
  display: flex;
  gap: var(--gap);
  flex-wrap: wrap;
}
.form-group {
  flex: 1;
  min-width: 200px;
  display: flex;
  flex-direction: column;
  margin-bottom: 1rem;
}
.form-group label {
  margin-bottom: 0.5rem;
  font-weight: 600;
  color: var(--secondary);
}
.select,
input[type="date"] {
  padding: 0.75rem;
  border: 1px solid #ccc;
  border-radius: var(--radius);
  font-size: 1rem;
  transition: border var(--transition);
}
.select:focus,
input:focus {
  outline: none;
  border-color: var(--primary);
}


.history-buttons {
  display: flex;
  gap: 1rem;
  justify-content: center;
  margin: 2rem 0;
}
.history-buttons .btn-secondary {
  padding: 0.75rem 1.5rem;
  border-radius: var(--radius);
  transition: background var(--transition), color var(--transition);
}
.history-buttons .btn-secondary.active,
.history-buttons .btn-secondary:hover {
  background: var(--secondary);
  color: var(--white);
}


.grid-cards {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap: var(--gap);
}
.card {
  position: relative;
  background: var(--white);
  border-radius: var(--radius);
  overflow: hidden;
  box-shadow: var(--shadow-light);
  cursor: pointer;
  transition: transform var(--transition), box-shadow var(--transition);
}
.card:hover {
  transform: translateY(-4px);
  box-shadow: var(--shadow-dark);
}
.card img {
  width: 100%;
  height: 140px;
  object-fit: cover;
}
.card-body {
  padding: 1rem;
  text-align: center;
  font-weight: 600;
  color: var(--secondary);
}
.quick-modal .modal {
  max-width: 320px;
  text-align: center;
}


.modal-overlay {
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background: rgba(0,0,0,0.6);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 2000;
  backdrop-filter: blur(4px);
}
.modal {
  background: var(--white);
  border-radius: var(--radius);
  max-width: 500px;
  width: 90%;
  padding: 2rem;
  box-shadow: var(--shadow-dark);
  position: relative;
  transition: transform var(--transition);
}
.close-btn {
  position: absolute;
  top: 1rem;
  right: 1rem;
  background: none;
  border: none;
  font-size: 1.2rem;
  cursor: pointer;
  color: var(--muted-text);
  transition: color var(--transition);
}
.close-btn:hover {
  color: var(--dark-text);
}

/* Ride History Modal Specific */
.history-modal h3 {
  margin-bottom: 1rem;
  color: var(--secondary);
}
.history-tabs {
  display: flex;
  justify-content: space-around;
  margin-bottom: 1.5rem;
}
.history-tabs .tab {
  background: var(--light-bg);
  border: none;
  padding: 0.5rem 1rem;
  border-radius: var(--radius);
  cursor: pointer;
  transition: background var(--transition), color var(--transition);
}
.history-tabs .tab.active,
.history-tabs .tab:hover {
  background: var(--secondary);
  color: var(--white);
}
.ride-list {
  max-height: 250px;
  overflow-y: auto;
  list-style: none;
  padding-left: 0;
  margin-bottom: 1rem;
}
.ride-list li {
  padding: 0.75rem;
  border-bottom: 1px solid #eee;
  cursor: pointer;
  transition: background var(--transition);
}
.ride-list li:hover {
  background: var(--light-bg);
}
.ride-detail {
  background: #fafafa;
  padding: 1rem;
  border-radius: var(--radius);
  text-align: center;
}
.ride-detail h4 {
  margin-bottom: 0.5rem;
  color: var(--secondary);
}

/* ---------------------------------------------------
   SUPPORT CHAT BUTTON
--------------------------------------------------- */
.support-chat-btn {
  position: fixed;
  bottom: 2rem;
  right: 2rem;
  background: var(--accent);
  color: var(--white);
  border: none;
  border-radius: 50%;
  width: 60px;
  height: 60px;
  font-size: 1.5rem;
  cursor: pointer;
  box-shadow: var(--shadow-dark);
  display: flex;
  align-items: center;
  justify-content: center;
  transition: transform var(--transition);
}
.support-chat-btn:hover {
  transform: scale(1.1);
}

/* ---------------------------------------------------
   FOOTER
--------------------------------------------------- */
.app-footer {
  text-align: center;
  padding: 2rem var(--gap);
  background: #f0f0f0;
  color: #555;
  font-size: 0.9rem;
}
.app-footer i {
  color: var(--accent);
  margin-left: 0.5rem;
}

/* ---------------------------------------------------
   RESPONSIVE
--------------------------------------------------- */
@media (max-width: 768px) {
  .header-inner { flex-wrap: wrap; text-align: center; }
  .desktop-only { display: none; }
  .hamburger { display: block; }
  .form-row { flex-direction: column; }
  .hero-title { font-size: 2.5rem; }
}
@media (max-width: 480px) {
  :root { --gap: 12px; }
  .hero-title { font-size: 2rem; }
  .hero-subtitle { font-size: 1rem; }
  .btn-primary, .btn-secondary { width: 100%; }
}


    .accordion .accordion-item { margin-bottom:1rem; }
    .accordion-header {
      width:100%; background:var(--white); border:1px solid #ccc;
      border-radius:var(--radius); padding:.75rem 1rem;
      display:flex; align-items:center; justify-content:space-between;
      cursor:pointer; transition:background var(--transition);
    }
    .accordion-body { display:none; padding:1rem; border-left:4px solid var(--accent); }

   

    /*— Footer —*/
    .app-footer { text-align:center; padding:1.5rem var(--gap); background:#f0f0f0; color:#555; font-size:.9rem; }
    .app-footer i { color:var(--accent); margin-left:.5rem; }

    /*— Responsive —*/
    @media(max-width:768px){
      .header-inner { flex-wrap:wrap; text-align:center; }
      .desktop-only { display:none; }
      .hamburger { display:block; }
      .form-row { flex-direction:column; }
      .hero { flex-direction:column; text-align:center; }
      .hero-content, .hero-image { max-width:100%; }
    }
    @media(max-width:480px){
      :root{--gap:12px;}
      .app-title{font-size:1.2rem;}
      .btn-primary, .btn-secondary{width:100%;}
    }

    /* Hero Section Enhancements */
.hero-section {
  position: relative;
  height: 90vh;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
  animation: fadeInHero 1s ease-out;
}

.hero-background img {
  position: absolute;
  top: 0; left: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
  filter: brightness(0.5);
}

.hero-overlay {
  position: absolute;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background: rgba(0,0,0,0.4);
}

.hero-content {
  position: relative;
  z-index: 2;
  text-align: center;
  color: var(--white);
  max-width: 800px;
  padding: 0 var(--gap);
  opacity: 0;
  animation: slideInUp 1s ease-out forwards 0.5s;
}

.hero-title {
  font-family: var(--font-alt);
  font-size: 3.5rem;
  font-weight: 700;
  margin-bottom: 1rem;
  white-space: nowrap;
  overflow: hidden;
  border-right: 3px solid var(--accent);
  width: 0;
  animation:
    typing 3s steps(30, end) forwards,
    blink-caret .75s step-end infinite 3s;
}

.hero-subtitle {
  font-size: 1.125rem;
  margin-bottom: 2rem;
  opacity: 0;
  animation: fadeInHero 1s ease-out forwards 2.5s;
}

.hero-buttons {
  opacity: 0;
  animation: fadeInHero 1s ease-out forwards 3s;
}

.hero-buttons button {
  margin: 0 0.5rem;
  padding: 0.75rem 2rem;
  font-size: 1rem;
  font-weight: 600;
  color: var(--white);
  background: var(--primary);
  border: none;
  border-radius: var(--radius);
  box-shadow: var(--shadow-light);
  cursor: pointer;
  transition: transform var(--transition), box-shadow var(--transition), background var(--transition);
}
.hero-buttons button:hover {
  background: var(--primary-dark);
  transform: translateY(-3px);
  box-shadow: var(--shadow-dark);
}

/* Bus Icon Animations */
.bus-animation {
  font-size: 2rem;
  opacity: 0.8;
  animation: busMove 4s ease-in-out infinite;
}
.bus-animations .bus-1 { animation-delay: 0s; }
.bus-animations .bus-2 { animation-delay: 0.5s; }
.bus-animations .bus-3 { animation-delay: 1s; }

/* Keyframes */
@keyframes fadeInHero {
  from { opacity: 0; }
  to   { opacity: 1; }
}
@keyframes slideInUp {
  from { transform: translateY(30px); opacity: 0; }
  to   { transform: translateY(0);  opacity: 1; }
}
@keyframes typing {
  from { width: 0; }
  to   { width: 100%; }
}
@keyframes blink-caret {
  50% { border-color: transparent; }
}
@keyframes busMove {
  0%   { transform: translateX(-100px) scale(0.8); opacity: 0; }
  50%  { opacity: 1; }
  100% { transform: translateX(100px) scale(1); opacity: 0; }
}

/* Responsive Adjustments */
@media (max-width: 768px) {
  .hero-title { font-size: 2.8rem; }
  .hero-subtitle { font-size: 1rem; }
  .hero-buttons button { width: 100%; margin: 0.5rem 0; }
}

@media (max-width: 480px) {
  .hero-title { font-size: 2rem; }
  .hero-subtitle { font-size: 0.9rem; }
  .hero-buttons button { padding: 0.75rem 1.5rem; font-size: 0.9rem; }
}

    /* Live Search */
.live-search {
  position: relative;
  max-width: 400px;
  margin: 1rem auto 1.5rem;
}
.live-search input {
  width: 100%;
  padding: 0.75rem 2.5rem 0.75rem 1rem;
  border-radius: var(--radius);
  border: 1px solid #ccc;
  font-size: 1rem;
  transition: border var(--transition);
}
.live-search input:focus {
  border-color: var(--primary);
  outline: none;
}
.search-icon {
  position: absolute;
  right: 1rem;
  top: 50%;
  transform: translateY(-50%);
  color: #888;
  pointer-events: none;
}

/* Shuttle Cards */
.live-cards {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
  gap: var(--gap);
}
.shuttle-card {
  background: var(--white);
  border-radius: var(--radius);
  padding: 1rem;
  box-shadow: var(--shadow-light);
  opacity: 0;
  transform: translateY(20px);
  animation: fadeInUp 0.6s ease-out forwards;
}
.shuttle-card h3 {
  margin-bottom: 0.5rem;
  color: var(--secondary);
}
.shuttle-card p {
  margin-bottom: 0.5rem;
}
.progress-bar {
  background: #eee;
  border-radius: var(--radius);
  height: 6px;
  overflow: hidden;
}
.progress-fill {
  height: 100%;
  background: var(--primary);
  transition: width var(--transition);
}

/* Pulsing marker */
.leaflet-interactive.pulse-marker {
  animation: pulse 1.8s ease-out infinite;
}
@keyframes pulse {
  0%   { r: 6; opacity: 0.6; }
  50%  { r: 12; opacity: 0.2; }
  100% { r: 6; opacity: 0.6; }
}

/* Card animation */
@keyframes fadeInUp {
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Ensure map & cards are responsive */
@media (max-width: 768px) {
  .live-cards { grid-template-columns: 1fr; }
}

    /* Booking Section */
.booking-section form {
  background: var(--white);
  padding: 2.5rem;
  border-radius: var(--radius);
  box-shadow: var(--shadow-dark);
  transition: box-shadow var(--transition);
}
.booking-section form:hover {
  box-shadow: var(--shadow-light);
}
.booking-section .form-group label {
  color: var(--secondary);
  margin-bottom: 0.5rem;
  font-weight: 600;
}
.booking-section .select,
.booking-section input[type="date"] {
  width: 100%;
  padding: 0.75rem 1rem;
  border: 2px solid #ccc;
  border-radius: var(--radius);
  font-size: 1rem;
  transition: border var(--transition), box-shadow var(--transition);
}
.booking-section .select:focus,
.booking-section input[type="date"]:focus {
  outline: none;
  border-color: var(--accent);
  box-shadow: 0 0 0 4px rgba(255,111,97,0.2);
}
.booking-section button[type="submit"] {
  margin-top: 1.5rem;
  padding: 0.75rem 2rem;
  font-size: 1.125rem;
  font-weight: 700;
  color: var(--white);
  background: var(--accent);
  border: none;
  border-radius: var(--radius);
  cursor: pointer;
  transition: background var(--transition), transform var(--transition);
}
.booking-section button[type="submit"]:hover {
  background: #e65550;
  transform: translateY(-2px);
}

    /* Confirmation Modal Styles */
.booking-confirm-modal {
  max-width: 380px;
  text-align: center;
}
.booking-confirm-modal h3 {
  color: var(--secondary);
  margin-bottom: 0.5rem;
}
.booking-confirm-modal p {
  margin: 0.75rem 0;
  color: var(--dark-text);
}
.booking-confirm-modal .qr-container {
  margin: 1rem 0;
  display: flex;
  justify-content: center;
}
.booking-confirm-modal canvas {
  width: 180px;
  height: 180px;
  border: 4px solid var(--secondary);
  border-radius: 12px;
}
.booking-confirm-modal .qr-note {
  font-size: 0.9rem;
  color: var(--muted-text);
  margin-bottom: 1.5rem;
}

    /* History Modal Enhancements */
.history-modal {
  max-width: 500px;
  padding: 2rem;
}
.history-modal h3 {
  font-family: var(--font-alt);
  font-size: 1.5rem;
  margin-bottom: 1rem;
  color: var(--secondary);
}
.history-tabs {
  display: flex;
  justify-content: space-around;
  margin-bottom: 1.5rem;
}
.history-tabs .tab {
  flex: 1;
  background: var(--light-bg);
  border: none;
  padding: 0.75rem;
  margin: 0 0.25rem;
  border-radius: var(--radius);
  font-weight: 600;
  cursor: pointer;
  transition: background var(--transition), color var(--transition);
}
.history-tabs .tab.active {
  background: var(--accent);
  color: var(--white);
}
.ride-list {
  max-height: 250px;
  overflow-y: auto;
  list-style: none;
  margin: 0;
  padding: 0;
}
.ride-list li {
  padding: 0.75rem 1rem;
  border-bottom: 1px solid #eee;
  cursor: pointer;
  transition: background var(--transition);
}
.ride-list li:hover,
.ride-list li.active {
  background: var(--light-bg);
}
.ride-detail {
  background: #fafafa;
  padding: 1rem;
  border-radius: var(--radius);
  margin-top: 1rem;
}
.ride-detail h4 {
  margin-bottom: 0.5rem;
  color: var(--secondary);
}
.ride-detail p {
  margin: 0.25rem 0;
}
/* Consistent button styling */
#ridesBtnLive,
#ridesBtnHeader,
#ridesBtnMobile {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.5rem 1rem;
  font-weight: 600;
  border-radius: var(--radius);
  border: none;
  cursor: pointer;
  transition: background var(--transition), color var(--transition);
}
#ridesBtnHeader { margin-left: 1rem; }
#ridesBtnHeader:hover,
#ridesBtnMobile:hover,
#ridesBtnLive:hover {
  background: var(--accent);
  color: var(--white);
}

    /* Support Chat Button */
.support-chat-btn {
  position: fixed;
  bottom: 2rem;
  right: 2rem;
  background: var(--accent);
  color: var(--white);
  border: none;
  border-radius: 50%;
  width: 60px;
  height: 60px;
  font-size: 1.5rem;
  cursor: pointer;
  box-shadow: var(--shadow-dark);
  display: flex;
  align-items: center;
  justify-content: center;
  transition: transform var(--transition), background var(--transition);
}
.support-chat-btn:hover {
  transform: scale(1.1);
  background: #e65550;
}

/* Support Modal */
.support-modal {
  max-width: 360px;
  text-align: center;
  padding: 2rem 1.5rem;
}
.support-modal h3 {
  font-family: var(--font-alt);
  color: var(--secondary);
  margin-bottom: 1rem;
}
.support-modal p {
  margin-bottom: 1rem;
  color: var(--dark-text);
}
.support-options {
  list-style: none;
  padding: 0;
  margin: 1rem 0;
  text-align: left;
}
.support-options li {
  display: flex;
  align-items: center;
  margin-bottom: 0.75rem;
  cursor: pointer;
  transition: color var(--transition);
}
.support-options li i {
  margin-right: 0.75rem;
  color: var(--primary);
}
.support-options li:hover {
  color: var(--accent);
}
.history-modal {
 max-height: 80vh;
 overflow-y: auto;
}
    /* Quick-Book Modal Button */
.quick-modal .btn-primary {
  margin-top: 1.5rem;
  padding: 0.75rem 2rem;
  font-size: 1rem;
  font-weight: 700;
  background: var(--primary);
  color: var(--white);
  border: none;
  border-radius: var(--radius);
  cursor: pointer;
  transition: background var(--transition), transform var(--transition);
}
.quick-modal .btn-primary:hover {
  background: var(--primary-dark);
  transform: translateY(-2px);
}

    /* FAQ Section */
.faq-section {
  background: var(--white);
  padding: 2rem var(--gap);
  border-radius: var(--radius);
  box-shadow: var(--shadow-light);
}
.faq-section h2 {
  margin-bottom: 1rem;
}
.accordion .accordion-item {
  margin-bottom: 1rem;
  border-radius: var(--radius);
  overflow: hidden;
}
.accordion-header {
  background: var(--light-bg);
  padding: 0.75rem 1rem;
  font-weight: 600;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: space-between;
  transition: background var(--transition);
}
.accordion-header:hover {
  background: var(--accent);
  color: var(--white);
}
.accordion-header i {
  transition: transform var(--transition);
}
.accordion-body {
  background: var(--white);
  padding: 1rem;
  border-left: 4px solid var(--accent);
  display: none;
  color: var(--dark-text);
  line-height: 1.4;
}
.accordion-body p {
  margin-bottom: 0.5rem;
}

/* Contact & Support Section */
.contact-section {
  background: var(--white);
  padding: 2rem var(--gap);
  border-radius: var(--radius);
  box-shadow: var(--shadow-light);
}
.contact-section h2 {
  margin-bottom: 1rem;
}
.contact-section p {
  margin-bottom: 0.75rem;
  display: flex;
  align-items: center;
  font-size: 1rem;
  color: var(--secondary);
}
.contact-section p i {
  margin-right: 0.75rem;
  color: var(--accent);
}
.social-icons {
  margin-top: 1rem;
}
.social-icons a {
  margin-right: 1rem;
  font-size: 1.5rem;
  color: var(--secondary);
  transition: color var(--transition), transform var(--transition);
}
.social-icons a:hover {
  color: var(--accent);
  transform: translateY(-2px);
}

    /* Sign‑In Modal */
.signin-overlay {
  display: flex;
  align-items: center;
  justify-content: center;
  background: rgba(0,0,0,0.6);
  position: fixed;
  inset: 0;
  z-index: 2000;
}

.signin-modal {
  background: var(--white);
  padding: 2rem;
  border-radius: var(--radius);
  box-shadow: var(--shadow-dark);
  max-width: 400px;
  width: 90%;
  text-align: center;
}

.signin-modal h3 {
  font-family: var(--font-alt);
  margin-bottom: 1.5rem;
  font-size: 1.5rem;
  color: var(--secondary);
}

.signin-modal form .form-group {
  text-align: left;
  margin-bottom: 1rem;
}

.signin-modal form label {
  display: block;
  margin-bottom: 0.5rem;
  font-weight: 600;
  color: var(--dark-text);
}

.signin-modal form input {
  width: 100%;
  padding: 0.75rem 1rem;
  border: 1px solid #ccc;
  border-radius: var(--radius);
  box-shadow: var(--shadow-light);
  transition: border var(--transition), box-shadow var(--transition);
}

.signin-modal form input:focus {
  outline: none;
  border-color: var(--primary);
  box-shadow: 0 0 0 3px rgba(0,123,255,0.2);
}

.signin-modal form button {
  margin-top: 1rem;
  width: 100%;
  padding: 0.75rem;
  font-size: 1rem;
  font-weight: 600;
  color: var(--white);
  background: var(--primary);
  border: none;
  border-radius: var(--radius);
  cursor: pointer;
  transition: background var(--transition), transform var(--transition);
}

.signin-modal form button:hover {
  background: var(--primary-dark);
  transform: translateY(-2px);
}

/* Ensure hero-content sits above animations */
.hero-content {
  position: relative;
  z-index: 3;
}

/* Fade-and-slide in for hero buttons */
.hero-buttons {
  opacity: 0;
  animation: fadeInButtons 0.8s ease-out forwards 3s;
}

@keyframes fadeInButtons {
  from   { opacity: 0; transform: translateY(20px); }
  to     { opacity: 1; transform: translateY(0); }
}

.hero-buttons button {
  transform: translateY(20px);
  animation: slideUpBtn 0.8s ease-out forwards 3s;
}

@keyframes slideUpBtn {
  from   { transform: translateY(20px); }
  to     { transform: translateY(0); }
}

.bus-animations {
  position: absolute;
  bottom: -5%;    
  left: 50%;
  transform: translateX(-50%);
  z-index: 2;
}

.bus-animation {
  animation:
    busMove 4s ease-in-out infinite,
    pulseScale 2s ease-in-out infinite;
}

@keyframes pulseScale {
  0%, 100% { transform: scale(1); }
  50%      { transform: scale(1.1); }
}

    .hero-title {
  white-space: normal;
  font-size: 3rem;        
  line-height: 1.2;        
}

.hero-buttons {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 1rem;
}

.hero-buttons button {
  padding: 0.75rem 1.5rem;
  font-weight: 600;
  font-size: 1rem;
  border-radius: var(--radius);
  border: none;
  cursor: pointer;
  box-shadow: var(--shadow-light);
  transition: background var(--transition), transform var(--transition);
}

/* Primary button */
.hero-buttons .btn-primary {
  background: var(--primary);
  color: var(--white);
}
.hero-buttons .btn-primary:hover {
  background: var(--primary-dark);
  transform: translateY(-2px);
}

/* Secondary button */
.hero-buttons .btn-secondary {
  background: var(--accent);
  color: var(--white);
}
.hero-buttons .btn-secondary:hover {
  background: #e65550;
  transform: translateY(-2px);
}

/* Responsive tweaks */
@media (max-width: 768px) {
  .hero-title {
    font-size: 2.5rem;
  }
  .hero-subtitle {
    font-size: 1rem;
  }
 .hero-buttons button { flex: none; width: auto; }
}
.support-options li a {
 color: var(--primary);
 text-decoration: none;
 font-weight: 600;
}
.support-options li a:hover {
 color: var(--accent);
}
     .chat-widget.hidden { display: none !important; }
    /* Booking section form controls */
.booking-section .form-group select,
.booking-section .form-group input {
  width: 100%;
  padding: 0.75rem 1rem;
  background: var(--white);
  border: 1px solid var(--muted-text);
  border-radius: var(--radius);
  box-shadow: var(--shadow-light);
  font-size: 1rem;
  transition: border var(--transition), box-shadow var(--transition);
}

.booking-section .form-group select:focus,
.booking-section .form-group input:focus {
  outline: none;
  border-color: var(--accent);
  box-shadow: 0 0 0 3px rgba(255,111,97,0.2);
}

    /* Chat Widget Styles */
.chat-widget {
  position: fixed;
  bottom: 80px;
  right: 20px;
  width: 300px;
  max-height: 400px;
  background: var(--white);
  border: 1px solid #ddd;
  border-radius: var(--radius);
  box-shadow: var(--shadow-dark);
  display: flex;
  flex-direction: column;
  overflow: hidden;
  transition: transform var(--transition);
  transform: translateY(100%);
  z-index: 3000;
}

.chat-widget.visible {
  transform: translateY(0);
}

.chat-header {
  background: var(--primary);
  color: var(--white);
  padding: 0.5rem 1rem;
  font-weight: 600;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.chat-close {
  background: none;
  border: none;
  color: var(--white);
  font-size: 1.2rem;
  cursor: pointer;
}

.chat-messages {
  flex: 1;
  padding: 0.75rem;
  overflow-y: auto;
}

.chat-messages .chat-user,
.chat-messages .chat-system {
  margin-bottom: 0.75rem;
  line-height: 1.4;
}

.chat-messages .chat-user {
  text-align: right;
  color: var(--white);
  background: var(--primary);
  display: inline-block;
  padding: 0.5rem 0.75rem;
  border-radius: var(--radius);
}

.chat-messages .chat-system {
  text-align: left;
  background: #f1f1f1;
  display: inline-block;
  padding: 0.5rem 0.75rem;
  border-radius: var(--radius);
}

.chat-input-area {
  display: flex;
  border-top: 1px solid #eee;
}

#chatInputField {
  flex: 1;
  border: none;
  padding: 0.75rem;
  font-size: 0.9rem;
}

#chatSendBtn {
  background: var(--accent);
  border: none;
  color: var(--white);
  padding: 0 1rem;
  cursor: pointer;
  transition: background var(--transition);
}

#chatSendBtn:hover {
  background: #e65550;
}

.info-sections {
  display: block;
  gap: var(--gap);
  margin: 4rem 0;
}

@media (min-width: 924px) {
  .info-sections {
    display: flex;
    justify-content: space-between;
  }
  .info-sections .faq-section,
  .info-sections .contact-section {
    flex: 1;
    max-width: calc(50% - var(--gap)/2);
  }
}

    .booking-confirm-modal button[data-close="confirmModal"] {
  margin-top: 1.5rem;
  padding: 0.75rem 2rem;
  font-size: 1.125rem;
  font-weight: 700;
  color: var(--white);
  background: var(--accent);
  border: none;
  border-radius: var(--radius);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  cursor: pointer;
  transition: background var(--transition), transform var(--transition);
}

.booking-confirm-modal button[data-close="confirmModal"]:hover {
  background: #e65550;
  transform: translateY(-2px);
}

#rideDetail .export-icon {
  display: block;
  font-size: 1.5rem;
  color: var(--accent);
  margin: 1rem auto 0;
  cursor: pointer;
  transition: color var(--transition);
}
#rideDetail .export-icon:hover {
  color: var(--accent-dark, #e6bd00);
}

  </style>
</head>
<body>
  <!-- Sign-In Overlay -->
  <div class="signin-overlay" id="signinOverlay">
    <div class="modal signin-modal">
      <h3><i class="fas fa-user-lock"></i> Student Sign In</h3>
      <form id="signinForm">
        <div class="form-group">
          <label for="studentId">Student ID</label>
          <input type="text" id="studentId" placeholder="8‑digit ID" maxlength="8" required>
        </div>
        <div class="form-group">
          <label for="username">Username</label>
          <input type="text" id="username" placeholder="Letters only" pattern="[A-Za-z]+" required>
        </div>
        <div class="form-group">
          <label for="password">Password</label>
          <input type="password" id="password" placeholder="At least 6 chars" minlength="6" required>
        </div>
        <button type="submit" class="btn-primary">
          <i class="fas fa-sign-in-alt"></i> Sign In
        </button>
      </form>
    </div>
  </div>

  <!-- Header & Nav -->
 <header class="app-header">
    <div class="header-inner">
      <img src="knust1.png" alt="KNUST Logo" class="logo">
      <h1 class="app-title"> KNUST Shuttle Tracker</h1>
      <button class="hamburger" id="hamburgerBtn"><i class="fas fa-bars"></i></button>
      <nav class="header-nav desktop-only">
        <button class="nav-btn active" data-target="hero"><i class="fas fa-home"></i> Home</button>
        <button class="nav-btn" data-target="live-shuttles"><i class="fas fa-route"></i> Live Shuttles</button>
        <button class="nav-btn" data-target="book-ride"><i class="fas fa-paper-plane"></i> Book Ride</button>
        <button class="nav-btn" data-target="quick-book"><i class="fas fa-thumbs-up"></i> Quick Book</button>
        <button class="nav-btn" id="ridesBtnHeader"><i class="fas fa-history"></i> My Rides</button>
      </nav>
    </div>
    <aside class="mobile-sidebar" id="mobileSidebar">
      <button class="close-sidebar" id="closeSidebar"><i class="fas fa-times"></i></button>
      <button class="nav-btn" data-target="hero"><i class="fas fa-home"></i> Home</button>
      <button class="nav-btn" data-target="live-shuttles"><i class="fas fa-route"></i> Live Shuttles</button>
      <button class="nav-btn" data-target="book-ride"><i class="fas fa-paper-plane"></i> Book Ride</button>
      <button class="nav-btn" data-target="quick-book"><i class="fas fa-thumbs-up"></i> Quick Book</button>
   <button class="nav-btn" id="ridesBtnMobile"><i class="fas fa-history"></i> My Rides</button>
    </aside>
  </header>


  <!-- Hero -->
  <section id="hero" class="hero-section">
    <div class="hero-background">
      <img src="shuttle.jpg" alt="Campus Shuttle Background">
      <div class="hero-overlay"></div>
    </div>
    <div class="hero-content">
      <h2 class="hero-title">Welcome to <span id="typewriter"></span></h2>
      <p class="hero-subtitle">Track, book and ride with confidence.</p>
      <div class="hero-buttons">
        <button class="btn-primary" data-scroll="book-ride"><i class="fas fa-paper-plane"></i> Book a Ride</button>
        <button class="btn-secondary" data-scroll="live-shuttles"><i class="fas fa-route"></i> See Live Shuttles</button>
      </div>
      <br>
      <div class="bus-animations">
        <div class="bus-animation bus-1"><i class="fas fa-shuttle-van"></i></div>
        <div class="bus-animation bus-2"><i class="fas fa-bus"></i></div>
        <div class="bus-animation bus-3"><i class="fas fa-bus-alt"></i></div>
      </div>
    </div>
  </section>

<br>
  <main class="container">

    <section id="live-shuttles" class="section live-section">
  <h2><i class="fas fa-route"></i> Live Shuttle Map & Status</h2>

  <div class="live-search">
   <input
    type="text"
    id="liveSearch"
    list="stop-list"
    placeholder="Choose a stop…"
    autocomplete="off"
  />
  <datalist id="stop-list">
    <option value="KSB">
    <option value="Medical Village">
    <option value="Brunei">
    <option value="Casely Hayeford">
    <option value="College of Science">
    <option value="Commercial Area">
  </datalist>
    <i class="fas fa-search search-icon"></i>
  </div>

  <div id="map" class="map-container"></div>

  <div id="liveCards" class="live-cards">
  </div>
</section>
<button class="btn-secondary" id="ridesBtnLive" style="display:block; margin:2rem auto;">
  <i class="fas fa-history"></i> My Rides
</button>
    <!-- Book Your Ride -->
    <section id="book-ride" class="section booking-section">
      <h2><i class="fas fa-paper-plane"></i> Book Your Ride</h2>
      <form id="bookingForm">
        <div class="form-row">
          <div class="form-group">
            <label for="pickup"><i class="fas fa-location-arrow"></i> Pick‑Up</label>
            <select id="pickup" required>
              <option value="">Select pick‑up</option>
              <option value="KSB">KSB</option>
              <option value="Medical Village">Medical Village</option>
              <option value="Brunei">Brunei</option>
              <option value="Casely Hayeford">Casely Hayeford</option>
              <option value="College of Science">College of Science</option>
              <option value="Commercial Area">Commercial Area</option>
            </select>
          </div>
          <div class="form-group">
            <label for="destination"><i class="fas fa-flag-checkered"></i> Destination</label>
            <select id="destination" required>
              <option value="">Select destination</option>
              <option value="KSB">KSB</option>
              <option value="Medical Village">Medical Village</option>
              <option value="Brunei">Brunei</option>
              <option value="Casely Hayeford">Casely Hayeford</option>
              <option value="College of Science">College of Science</option>
              <option value="Commercial Area">Commercial Area</option>
            </select>
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label for="date"><i class="fas fa-calendar-alt"></i> Date</label>
            <input type="date" id="date" required>
          </div>
          <div class="form-group">
            <label for="timeslot"><i class="fas fa-clock"></i> Time Slot</label>
            <select id="timeslot" required>
              <option value="">Select time</option>
              <option>6:00 AM – 7:00 AM</option>
              <option>7:00 AM – 8:00 AM</option>
              <option>8:00 AM – 9:00 AM</option>
              <option>9:00 AM –10:00 AM</option>
              <option>10:00 AM –11:00 AM</option>
              <option>12:00 PM – 1:00 PM</option>
              <option>1:00 PM – 2:00 PM</option>
              <option>3:00 PM – 4:00 PM</option>
            </select>
          </div>
        </div>
        <button type="submit" class="btn-primary"><i class="fas fa-paper-plane"></i> Confirm Booking</button>
      </form>
    </section>

    <!-- Ride History Buttons -->
    <div class="history-buttons">
      <button id="prevRidesBtn" class="btn-secondary active"><i class="fas fa-archive"></i> Previous Rides</button>
      <button id="upcomingRidesBtn" class="btn-secondary"><i class="fas fa-clock"></i> Upcoming Rides</button>
      <button id="allRidesBtn" class="btn-secondary"><i class="fas fa-list"></i> All Rides</button>
    </div>

    <!-- Quick Book Cards -->
    <section id="quick-book" class="section quick-book-section">
      <h2><i class="fas fa-thumbs-up"></i> Quick Book Popular Stops</h2>
      <div class="grid-cards">
        <div class="card" data-page="ksbQuickModal">
          <img src="ksb.webp" alt="KSB">
          <div class="card-body"><p>KSB</p></div>
        </div>
        <div class="card" data-page="medicalQuickModal">
          <img src="medical.jpg" alt="Medical Village">
          <div class="card-body"><p>Medical Village</p></div>
        </div>
        <div class="card" data-page="bruneiQuickModal">
          <img src="brunei.jpeg" alt="Brunei">
          <div class="card-body"><p>Brunei</p></div>
        </div>
        <div class="card" data-page="caselyQuickModal">
          <img src="casely.jpg" alt="Casely Hayeford">
          <div class="card-body"><p>Casely Hayeford</p></div>
        </div>
        <div class="card" data-page="scienceQuickModal">
          <img src="science.jpg" alt="College of Science">
          <div class="card-body"><p>College of Science</p></div>
        </div>
        <div class="card" data-page="commerceQuickModal">
          <img src="commercial.jpg" alt="Commercial Area">
          <div class="card-body"><p>Commercial Area</p></div>
        </div>
      </div>
    </section>

  </main>

 <!-- Ride History Modal -->
<div class="modal-overlay" id="historyModal">
  <div class="modal history-modal">
    <button class="close-btn" data-close="historyModal"><i class="fas fa-times"></i></button>
    <h3><i class="fas fa-history"></i> My Rides</h3>
    <div class="history-tabs">
      <button class="tab active" data-tab="prev">Previous</button>
      <button class="tab" data-tab="upcoming">Upcoming</button>
      <button class="tab" data-tab="all">All</button>
    </div>
    <ul class="ride-list" id="rideList">
      <!-- filled by JS -->
    </ul>
    <div class="ride-detail" id="rideDetail">
      <p>Select a ride to view details.</p>
    </div>
  </div>
</div>


  <!-- Quick Book Modals -->
  <div class="modal-overlay" id="ksbQuickModal">
    <div class="modal quick-modal">
      <button class="close-btn" data-close="ksbQuickModal"><i class="fas fa-times"></i></button>
      <h3><i class="fas fa-university"></i> Quick Book: KSB</h3>
      <p>Secure your seat on the next shuttle departing to/from KSB.</p>
      <button class="btn-primary" data-scroll="book-ride"><i class="fas fa-paper-plane"></i> Book Now</button>
    </div>
  </div>
  <div class="modal-overlay" id="medicalQuickModal">
    <div class="modal quick-modal">
      <button class="close-btn" data-close="medicalQuickModal"><i class="fas fa-times"></i></button>
      <h3><i class="fas fa-hospital"></i> Quick Book: Medical Village</h3>
      <p>Reserve your spot for the next shuttle at Medical Village.</p>
      <button class="btn-primary" data-scroll="book-ride"><i class="fas fa-paper-plane"></i> Book Now</button>
    </div>
  </div>
  <div class="modal-overlay" id="bruneiQuickModal">
    <div class="modal quick-modal">
      <button class="close-btn" data-close="bruneiQuickModal"><i class="fas fa-times"></i></button>
      <h3><i class="fas fa-tree"></i> Quick Book: Brunei</h3>
      <p>Get on the green route—book your Brunei shuttle now.</p>
      <button class="btn-primary" data-scroll="book-ride"><i class="fas fa-paper-plane"></i> Book Now</button>
    </div>
  </div>
  <div class="modal-overlay" id="caselyQuickModal">
    <div class="modal quick-modal">
      <button class="close-btn" data-close="caselyQuickModal"><i class="fas fa-times"></i></button>
      <h3><i class="fas fa-university"></i> Quick Book: Casely Hayeford</h3>
      <p>Hop on the shuttle serving Casely Hayeford—reserve now.</p>
      <button class="btn-primary" data-scroll="book-ride"><i class="fas fa-paper-plane"></i> Book Now</button>
    </div>
  </div>
  <div class="modal-overlay" id="scienceQuickModal">
    <div class="modal quick-modal">
      <button class="close-btn" data-close="scienceQuickModal"><i class="fas fa-times"></i></button>
      <h3><i class="fas fa-flask"></i> Quick Book: College of Science</h3>
      <p>Lock in your seat to/from the College of Science shuttle.</p>
      <button class="btn-primary" data-scroll="book-ride"><i class="fas fa-paper-plane"></i> Book Now</button>
    </div>
  </div>
  <div class="modal-overlay" id="commerceQuickModal">
    <div class="modal quick-modal">
      <button class="close-btn" data-close="commerceQuickModal"><i class="fas fa-times"></i></button>
      <h3><i class="fas fa-shopping-bag"></i> Quick Book: Commercial Area</h3>
      <p>Secure your seat on the busy Commercial Area route.</p>
      <button class="btn-primary" data-scroll="book-ride"><i class="fas fa-paper-plane"></i> Book Now</button>
    </div>
  </div>

  <!-- Floating Support Chat -->
<button id="supportChat" class="support-chat-btn">
  <i class="fas fa-headset"></i>
</button>

<div class="info-sections">
    <section class="section faq-section" id="faq">
      <h2><i class="fas fa-question-circle"></i> FAQs</h2>
      <div class="accordion">
        <div class="accordion-item">
          <button class="accordion-header"><i class="fas fa-chevron-down"></i> How do I cancel?</button>
          <div class="accordion-body">Tap the trash icon in “My Rides.”</div>
        </div>
        <div class="accordion-item">
          <button class="accordion-header"><i class="fas fa-chevron-down"></i> Can I book for others?</button>
          <div class="accordion-body">Yes—enter their student ID in the form.</div>
        </div>
        <div class="accordion-item">
          <button class="accordion-header"><i class="fas fa-chevron-down"></i> Weekend service?</button>
          <div class="accordion-body">Saturdays 7 AM–2 PM, no service Sundays.</div>
        </div>
        <div class="accordion-item">
          <button class="accordion-header"><i class="fas fa-chevron-down"></i> Night shuttles?</button>
          <div class="accordion-body">8 PM–11 PM under “Late Rides.”</div>
        </div>
      </div>
    </section>

    <!-- Contact -->
    <section class="section contact-section" id="contact">
      <h2><i class="fas fa-envelope"></i> Contact & Support</h2>
      <p><i class="fas fa-phone-alt"></i> +233 24 123 4567</p>
      <p><i class="fas fa-envelope-open-text"></i> support@knust-shuttle.app</p>
      <div class="social-icons">
        <a href="#"><i class="fab fa-facebook-square"></i></a>
        <a href="#"><i class="fab fa-twitter-square"></i></a>
        <a href="#"><i class="fab fa-instagram-square"></i></a>
        <a href="#"><i class="fab fa-linkedin"></i></a>
      </div>
    </section>
</div>
  </main>

<!-- Booking Confirmation Modal -->
<div class="modal-overlay" id="confirmModal">
  <div class="modal booking-confirm-modal">
    <button class="close-btn" data-close="confirmModal">
      <i class="fas fa-times"></i>
    </button>
    <h3><i class="fas fa-check-circle"></i> Booking Confirmed!</h3>
    <p>
      Your shuttle from
      <strong id="confPickup"></strong>
      to
      <strong id="confDestination"></strong>
      on
      <strong id="confDate"></strong>
      at
      <strong id="confTime"></strong>
      is now reserved.
    </p>
    <div class="qr-container">
      <canvas id="confirmQr"></canvas>
    </div>
    <p class="qr-note">
      You can always access this QR code later under <strong>My Rides</strong>.
    </p>
    <button class="btn-primary" data-close="confirmModal">
      <i class="fas fa-thumbs-up"></i> Great!
    </button>
  </div>
</div>

  <!-- Live Support Modal -->
<div class="modal-overlay" id="supportModal">
  <div class="modal support-modal">
    <button class="close-btn" data-close="supportModal"><i class="fas fa-times"></i></button>
    <h3><i class="fas fa-headset"></i> Live Support</h3>
    <p>Hi there! 👋 How can we assist you today?</p>
    <ul class="support-options">
      <li>
    <i class="fas fa-question-circle"></i>
    <a href="faq.html" target="_blank">FAQ &amp; Help Center</a>
  </li>
  <li>
    <i class="fas fa-envelope"></i>
    <a href="mailto:support@knust-shuttle.app">Email Support</a>
  </li>
  <li>
    <i class="fas fa-phone-alt"></i>
    <a href="tel:+233241234567">Call Us</a>
  </li>
  <li>
    <i class="fas fa-comments"></i>
    <a href="#" id="chatAgentBtn">Chat with an Agent</a>
  </li>  
    </ul>
  </div>
</div>
<!-- Chat Widget -->
<div id="chatWidget" class="chat-widget hidden">
  <div class="chat-header">
    <span>Live Chat</span>
    <button id="closeChatBtn" class="chat-close">&times;</button>
  </div>
  <div id="chatMessages" class="chat-messages">
    <div class="chat-system">Hi there! 👋 How can we help you today?</div>
  </div>
  <div class="chat-input-area">
    <input id="chatInputField" type="text" placeholder="Type your message…" />
    <button id="chatSendBtn">Send</button>
  </div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

  <!-- Footer -->
  <footer class="app-footer">
    <p>&copy; 2025 KNUST Shuttle Tracker — Built with <i class="fas fa-heart"></i> by a KNUST Student</p>
  </footer>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js"></script>

  <script>
  const hero = document.querySelector('.hero-section');
  const bg    = hero.querySelector('.hero-background img');
  const buses = hero.querySelectorAll('.bus-animation');

  hero.addEventListener('mousemove', e => {
    const rect = hero.getBoundingClientRect();
    const xPct = (e.clientX - rect.left) / rect.width  - 0.5;
    const yPct = (e.clientY - rect.top)  / rect.height - 0.5;

    gsap.to(bg, {
      x: xPct * 30,
      y: yPct * 20,
      duration: 1,
      ease: 'power3.out'
    });

    buses.forEach((bus, i) => {
      gsap.to(bus, {
        x: xPct * (20 + i * 10),
        y: yPct * (10 + i * 5),
        rotationY: xPct * 10,
        duration: 1,
        ease: 'power3.out'
      });
    });
  });

  hero.addEventListener('mouseleave', () => {
    gsap.to([bg, ...buses], {
      x: 0, y: 0, rotationY: 0, duration: 1, ease: 'power3.out'
    });
  });
</script>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // --- SIGN‑IN OVERLAY ---
  const signinOverlay = document.getElementById('signinOverlay');
  const signinForm    = document.getElementById('signinForm');
  if (localStorage.getItem('signedIn') === 'true') {
    signinOverlay.style.display = 'none';
  } else {
    signinOverlay.style.display = 'flex';
  }
  signinForm.addEventListener('submit', e => {
    e.preventDefault();
    localStorage.setItem('signedIn', 'true');
    signinOverlay.style.display = 'none';
  });

  // --- MAP SETUP ---
  const map = L.map('map', { zoomControl: true }).setView([6.6667, -1.5833], 15);
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '&copy; OpenStreetMap contributors'
  }).addTo(map);

  function refreshMap() { setTimeout(()=> map.invalidateSize(), 200); }
  window.addEventListener('resize', refreshMap);
  
  // Fix map container sizing
  setTimeout(() => map.invalidateSize(), 200);

  // Stops coordinates
  const stops = {
    'KSB':               [6.6670, -1.5830],
    'Medical Village':   [6.6680, -1.5800],
    'Brunei':            [6.6660, -1.5850],
    'Casely Hayeford':   [6.6720, -1.5805],
    'College of Science':[6.6650, -1.5820],
    'Commercial Area':   [6.6675, -1.5870]
  };
  // Add markers for each stop
  Object.entries(stops).forEach(([name, coords]) => {
    L.marker(coords).addTo(map).bindPopup(name);
  });

   map.on('click', e => {
    let minDist = Infinity, nearest = null;
    Object.entries(stops).forEach(([name, coords]) => {
      const d = map.distance(e.latlng, L.latLng(coords));
      if (d < minDist) [minDist, nearest] = [d, { name, coords }];
    });
    if (nearest && minDist < 500) {
      L.popup()
        .setLatLng(nearest.coords)
        .setContent(`Nearest Stop: <strong>${nearest.name}</strong>`)
        .openOn(map);
    }
  });
  
  const liveSearch = document.getElementById('liveSearch');
  liveSearch.addEventListener('keydown', e => {
    if (e.key === 'Enter') {
      e.preventDefault();
       const term = liveSearch.value.trim();
     if (!stops[term]) {
        return alert('Please pick one of the six predefined stops.');
      }
      map.setView(stops[term], 17, { animate: true });
      L.popup({ autoClose: true })
        .setLatLng(stops[term])
        .setContent(`<strong>${term}</strong>`)
        .openOn(map);
    } 
    
  });

  liveSearch.addEventListener('input', () => {
  renderLiveShuttles(liveSearch.value.trim());
});

  // --- SIDE BAR (Mobile) ---
  const hamBtn      = document.getElementById('hamburgerBtn');
  const mobileNav   = document.getElementById('mobileSidebar');
  const closeNavBtn = document.getElementById('closeSidebar');
  hamBtn.addEventListener('click', () => mobileNav.style.left = '0');
  closeNavBtn.addEventListener('click', () => mobileNav.style.left = '-260px');

  // --- SMOOTH SCROLL & NAV ACTIVATION ---
  const headerHeight = document.querySelector('.app-header').offsetHeight;
  function scrollToSection(id) {
    document.getElementById(id).scrollIntoView({ behavior: 'smooth' });
    window.scrollBy(0, -headerHeight);
    mobileNav.style.left = '-260px';
  }
  document.querySelectorAll('.nav-btn').forEach(btn => {
    if (btn.dataset.target) {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        scrollToSection(btn.dataset.target);
       if (btn.dataset.target === 'live-shuttles') refreshMap();
      });
    }
  });
  document.querySelectorAll('[data-scroll]').forEach(btn => {
    btn.addEventListener('click', () => scrollToSection(btn.dataset.scroll));
  });

   ['prevRidesBtn','upcomingRidesBtn','allRidesBtn'].forEach(id => {
    document.getElementById(id).addEventListener('click', () => {
      const filter = id === 'prevRidesBtn'
        ? 'prev'
        : id === 'upcomingRidesBtn'
          ? 'upcoming'
          : 'all';
      renderHistory(filter);
      historyModal.style.display = 'flex';
    });
  });
  
  // --- TYPEWRITER ---
  const typeEl = document.getElementById('typewriter');
  const words  = ['Your Campus Commute', 'The Smart Shuttle Tracker', 'KNUST Shuttle Tracker'];
  let wIndex = 0, cIndex = 0, forward = true;
  function tick() {
    const current = words[wIndex];
    if (forward) {
      typeEl.textContent = current.slice(0, ++cIndex);
      if (cIndex === current.length) {
        setTimeout(() => forward = false, 1200);
      }
    } else {
      typeEl.textContent = current.slice(0, --cIndex);
      if (cIndex === 0) {
        forward = true;
        wIndex = (wIndex + 1) % words.length;
      }
    }
    setTimeout(tick, forward ? 100 : 50);
  }
  tick();

  // --- LIVE SHUTTLES DATA & RENDERING ---
  let liveData = [
    { route: 'KSB → Medical Village', eta: 5, cap: 30 },
    { route: 'Brunei → Commercial Area', eta: 2, cap: 25 },
    { route: 'Medical Village → Brunei', eta: 8, cap: 28 },
    { route: 'Commercial Area → KSB', eta: 12, cap: 22 },
    { route: 'Casely Hayeford → College of Science', eta: 7, cap: 35 },
    { route: 'College of Science → KSB', eta: 4, cap: 32 }
  ];
  const liveCards = document.getElementById('liveCards');
  const shuttleMarkers = L.layerGroup().addTo(map);

  function renderLiveShuttles(filter = '') {
    liveCards.innerHTML = '';
    shuttleMarkers.clearLayers();
    const term = filter.trim().toLowerCase();
    const filtered = liveData.filter(item =>
      item.route.toLowerCase().includes(term)
    );
      filtered.forEach((item, i) => {
      const busId = 'Bus-' + (i + 101);
      const routeColor = ['#007bff','#28a745','#ffc107','#17a2b8','#dc3545','#6f42c1'][i % 6];
      const card = document.createElement('div');
      card.className = 'shuttle-card';
      card.style.borderLeft = `4px solid ${routeColor}`;
      card.innerHTML = `
        <h3>${item.route}</h3>
        <p><strong>ID:</strong> ${busId}</p>
        <p><strong>ETA:</strong> ${item.eta} min</p>
        <p><strong>Seats:</strong> ${item.cap}</p>
        <div class="occupancy">
          <span>Occupancy:</span>
          <div class="occ-bar"><div class="occ-fill" style="width:${100 - item.cap}%"></div></div>
        </div>
        <p class="updated"><small>Last updated: <span class="time">${new Date().toLocaleTimeString()}</span></small></p>
        <button class="view-map" data-route="${i}">View on map</button>`;
      card.style.animationDelay = `${i * 0.1}s`;
      liveCards.appendChild(card);

      const [from, to] = item.route.split(' → ');
      const coordA = stops[from], coordB = stops[to];
      if (coordA && coordB) {
        const lat = (coordA[0] + coordB[0]) / 2;
        const lng = (coordA[1] + coordB[1]) / 2;
        const marker = L.circleMarker([lat, lng], {
          radius: 12,
          color: getComputedStyle(document.documentElement).getPropertyValue('--accent'),
          fillColor: getComputedStyle(document.documentElement).getPropertyValue('--accent'),
          fillOpacity: 0.7,
          className: 'pulse-marker'
        }).addTo(shuttleMarkers);
        marker.bindPopup(`${item.route}<br>ETA: ${item.eta} min`);
      }
    });
  }

  setInterval(() => {
    liveData.forEach(item => {
      item.eta = Math.max(1, item.eta - 1);
      item.cap = Math.max(0, item.cap - Math.floor(Math.random() * 2));
    });
    renderLiveShuttles(liveSearch.value);
    document.querySelectorAll('.shuttle-card .time').forEach(el =>
    el.textContent = new Date().toLocaleTimeString()
  );
  }, 10000);

  renderLiveShuttles();

  // --- BOOKING & LOCALSTORAGE PERSISTENCE ---
  const bookings = JSON.parse(localStorage.getItem('ksbBookings') || '[]');
  const bookingForm = document.getElementById('bookingForm');
  const confirmModal    = document.getElementById('confirmModal');
  const confPickup      = document.getElementById('confPickup');
  const confDestination = document.getElementById('confDestination');
  const confDate        = document.getElementById('confDate');
  const confTime        = document.getElementById('confTime');
  const confirmQr       = new QRious({ element: document.getElementById('confirmQr'), size: 200 });

  bookingForm.addEventListener('submit', e => {
    e.preventDefault();
    const p  = pickup.value;
    const d  = destination.value;
    const dt = date.value;
    const ts = timeslot.value;
    if (!p || !d || !dt || !ts || p === d) {
      alert('Please fill all fields and ensure pickup ≠ destination.');
      return;
    }
    const id = Date.now();
    bookings.push({ id, p, d, dt, ts });
    localStorage.setItem('ksbBookings', JSON.stringify(bookings));

    confPickup.textContent      = p;
    confDestination.textContent = d;
    confDate.textContent        = new Date(dt).toLocaleDateString();
    confTime.textContent        = ts;
    confirmQr.value = JSON.stringify({ pickup: p, destination: d, date: dt, time: ts });
    confirmModal.style.display = 'flex';
    bookingForm.reset();
  });

  document.querySelectorAll('[data-close="confirmModal"]').forEach(btn => {
    btn.addEventListener('click', () => confirmModal.style.display = 'none');
  });

  // --- RIDE HISTORY MODAL ---
  const historyModal = document.getElementById('historyModal');
  const rideList     = document.getElementById('rideList');
  const rideDetail   = document.getElementById('rideDetail');
  const historyTabs  = document.querySelectorAll('.history-tabs .tab');
  const todayDate    = new Date().toISOString().split('T')[0];

  function renderHistory(filter) {
    rideList.innerHTML = '';
    rideDetail.innerHTML = '<p>Select a ride to view details.</p>';
    const filtered = bookings.filter(b => {
      if (filter === 'prev')     return b.dt < todayDate;
      if (filter === 'upcoming') return b.dt >= todayDate;
      return true;
    });
    if (!filtered.length) {
      rideList.innerHTML = '<li>No rides found.</li>';
      return;
    }
    historyTabs.forEach(tab => {
      tab.classList.toggle('active', tab.dataset.tab === filter);
    });
    filtered.forEach(b => {
      const li = document.createElement('li');
      li.textContent = `${b.p} → ${b.d} — ${b.dt} @ ${b.ts}`;
      li.dataset.id = b.id;
      rideList.appendChild(li);
    });
  }

  historyTabs.forEach(tab => {
    tab.addEventListener('click', () => renderHistory(tab.dataset.tab));
  });

  rideList.addEventListener('click', e => {
    if (e.target.tagName !== 'LI') return;
    rideList.querySelectorAll('li').forEach(li => li.classList.remove('active'));
    e.target.classList.add('active');
    const ride = bookings.find(b => b.id == e.target.dataset.id);
   rideDetail.innerHTML = `
   <h4>Ride Details</h4>
    <p><strong>From:</strong> ${ride.p}</p>
    <p><strong>To:</strong> ${ride.d}</p>
    <p><strong>Date:</strong> ${ride.dt}</p>
    <p><strong>Time:</strong> ${ride.ts}</p>
    <canvas id="rideQr"></canvas>
    <i id="exportRide" class="fas fa-download export-icon" title="Download ride details"></i>
  `;
    new QRious({ element: document.getElementById('rideQr'), size: 180, value: JSON.stringify(ride) });
    document.getElementById('exportRide').addEventListener('click', () => {
   html2canvas(rideDetail, { backgroundColor: null }).then(canvas => {
      canvas.toBlob(blob => {
        const url = URL.createObjectURL(blob);
        const a   = document.createElement('a');
        a.href    = url;
        a.download = `ride-${ride.id}.png`;
        a.click();
        URL.revokeObjectURL(url);
      });
    });
  });
  });

  document.querySelector('[data-close="historyModal"]').addEventListener('click', () => {
    historyModal.style.display = 'none';
  });

  ['ridesBtnHeader','ridesBtnLive','ridesBtnMobile'].forEach(id => {
    document.getElementById(id).addEventListener('click', () => {
      renderHistory('all');
      historyModal.style.display = 'flex';
    });
  });

  document.addEventListener('click', e => {
  const btn = e.target.closest('.view-map');
  if (!btn) return;
  const idx = +btn.dataset.route;
  const item = liveData[idx];
  const [from, to] = item.route.split(' → ');
  const coordA = stops[from], coordB = stops[to];
  if (coordA && coordB) {
    const mid = [(coordA[0]+coordB[0])/2, (coordA[1]+coordB[1])/2];
    map.setView(mid, 16, { animate: true });
    L.popup()
      .setLatLng(mid)
      .setContent(`<strong>${item.route}</strong><br/>ETA: ${item.eta} min`)
      .openOn(map);
  }
});
  
  // --- QUICK BOOK MODALS ---
  document.querySelectorAll('.card[data-page]').forEach(card => {
    const modal = document.getElementById(card.dataset.page);
    card.addEventListener('click', () => modal.style.display = 'flex');
  });
  document.querySelectorAll('.close-btn[data-close]').forEach(btn => {
    btn.addEventListener('click', () => {
      document.getElementById(btn.dataset.close).style.display = 'none';
    });
  });

  // --- FAQ ACCORDION ---
  document.querySelectorAll('.accordion-header').forEach(header => {
    header.addEventListener('click', () => {
      const body = header.nextElementSibling;
      const icon = header.querySelector('i.fa-chevron-down');
      if (body.style.display === 'block') {
        body.style.display = 'none';
        icon.style.transform = '';
      } else {
        body.style.display = 'block';
        icon.style.transform = 'rotate(180deg)';
      }
    });
  });

  // --- LIVE SUPPORT & CHAT WIDGET ---
  const supportChat  = document.getElementById('supportChat');
  const supportModal = document.getElementById('supportModal');
  const chatWidget   = document.getElementById('chatWidget');
  const chatAgentBtn = document.getElementById('chatAgentBtn');
  const closeChatBtn = document.getElementById('closeChatBtn');

  supportChat.addEventListener('click', () => {
    supportModal.style.display = 'flex';
  });
  supportModal.addEventListener('click', e => {
    if (e.target === supportModal || e.target.closest('[data-close="supportModal"]')) {
      supportModal.style.display = 'none';
    }
  });
  chatAgentBtn.addEventListener('click', e => {
    e.preventDefault();
    supportModal.style.display = 'none';
    chatWidget.classList.remove('hidden');
    chatWidget.classList.add('visible');
  });
  closeChatBtn.addEventListener('click', () => {
    chatWidget.classList.add('hidden');
    chatWidget.classList.remove('visible');
  });

  // CHAT MESSAGE HANDLER
  const chatInput   = document.getElementById('chatInputField');
  const chatSendBtn = document.getElementById('chatSendBtn');
  const chatMessages= document.getElementById('chatMessages');
  function appendMessage(text, isUser) {
    const div = document.createElement('div');
    div.className = isUser ? 'chat-user' : 'chat-system';
    div.textContent = text;
    chatMessages.appendChild(div);
    chatMessages.scrollTop = chatMessages.scrollHeight;
  }
  chatSendBtn.addEventListener('click', () => {
    const msg = chatInput.value.trim();
    if (!msg) return;
    appendMessage(msg, true);
    chatInput.value = '';
    setTimeout(() => {
      appendMessage('Thanks for your message! An agent will be with you shortly.', false);
    }, 1000);
  });
  chatInput.addEventListener('keydown', e => {
    if (e.key === 'Enter') {
      e.preventDefault();
      chatSendBtn.click();
    }
  });

  // Close mobile sidebar on outside click
  document.addEventListener('click', e => {
    if (!mobileNav.contains(e.target) && !hamBtn.contains(e.target)) {
      mobileNav.style.left = '-260px';
    }
  });
});
</script>


</body>
</html>
