<!DOCTYPE html>
<html lang="en" class="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <title>Vitra – KNUST Shuttle Tracker</title>

  <!-- Fonts & Icons -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600;700&display=swap" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=Raleway:wght@400;700&display=swap" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
  <!-- (Optional) Leaflet CSS if you integrate a map later -->
  <!-- <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/> -->

  <style>
    /*— Reset & Variables —*/
    * { margin:0; padding:0; box-sizing:border-box; }
    :root {
      --primary: #007bff;
      --primary-dark: #0056b3;
      --secondary: #00274d;
      --accent: #ff6f61;
      --light-bg: #f5fcff;
      --white: #fff;
      --dark-text: #222;
      --gap: 20px;
      --radius: 12px;
      --max-width: 1200px;
      --shadow: 0 4px 16px rgba(0,0,0,0.1);
      --transition: .3s ease;
      --font: 'Poppins', sans-serif;
    }
    body {
      font-family: var(--font);
      background: linear-gradient(135deg, #e9f5ff, #f5fcff);
      color: var(--dark-text);
      line-height:1.5;
      overflow-x:hidden;
    }
    img { display:block; max-width:100%; }

    /*— Header —*/
    .app-header {
      position:sticky; top:0; width:100%;
      background:var(--secondary); color:var(--white);
      box-shadow:var(--shadow); z-index:1000;
    }
    .header-inner {
      max-width:var(--max-width); margin:0 auto;
      display:flex; align-items:center; justify-content:space-between;
      padding:1rem var(--gap);
    }
    .app-title { font-size:1.5rem; font-weight:700; display:flex; align-items:center; }
    .app-title i { margin-right:0.5rem; color:var(--accent); }
    .nav-btn {
      background:none; border:none; color:var(--white);
      font-size:1rem; margin-left:1rem; cursor:pointer; transition:color var(--transition);
    }
    .nav-btn.active, .nav-btn:hover { color:var(--accent); }
    .hamburger { display:none; background:none; border:none; font-size:1.5rem; cursor:pointer; }
    .mobile-sidebar {
      position:fixed; top:0; left:-260px; width:260px; height:100%;
      background:var(--secondary); padding:2rem 1rem;
      transition:left var(--transition); z-index:2000;
    }
    .mobile-sidebar .nav-btn { display:block; width:100%; text-align:left; margin-bottom:1rem; }
    .close-sidebar { background:none; border:none; color:var(--white); font-size:1.2rem; margin-bottom:2rem; cursor:pointer; }

    /*— Hero —*/
    .hero {
      display:flex; align-items:center; justify-content:space-between;
      background:var(--white); margin:var(--gap) auto; padding:2rem var(--gap);
      border-radius:var(--radius); box-shadow:var(--shadow);
      max-width:var(--max-width);
    }
    .hero-content { max-width:50%; }
    .hero-content h2 { font-size:2rem; color:var(--secondary); margin-bottom:1rem; }
    .hero-content p { margin-bottom:1.5rem; }
    .hero-buttons button { margin-right:1rem; }
    .hero-features {
      list-style:none; margin-top:1rem; padding-left:0;
    }
    .hero-features li {
      margin-bottom:.5rem; display:flex; align-items:center;
    }
    .hero-features li i { margin-right:.5rem; color:var(--accent); }
    .hero-image img { border-radius:var(--radius); box-shadow:var(--shadow); }

    /*— Sections —*/
    .container { max-width:var(--max-width); margin:0 auto; padding:0 var(--gap); }
    .section { margin-bottom:var(--gap*1.5); }
    .section h2 {
      font-size:1.4rem; margin-bottom:1rem; display:flex; align-items:center;
    }
    .section h2 i { margin-right:.5rem; color:var(--accent); }

    /*— Forms —*/
    .form-row { display:flex; gap:var(--gap); flex-wrap:wrap; }
    .form-group {
      flex:1; min-width:200px; display:flex; flex-direction:column;
      margin-bottom:1rem;
    }
    .form-group label { margin-bottom:.5rem; font-weight:600; }
    .select, input[type="date"], input[type="number"], input[type="text"] {
      padding:.75rem; border:1px solid #ccc; border-radius:var(--radius);
      font-size:1rem; transition:border var(--transition);
    }
    .select:focus, input:focus { outline:none; border-color:var(--primary); }

    /*— Buttons —*/
    .btn-primary, .btn-secondary {
      display:inline-flex; align-items:center; justify-content:center;
      padding:.75rem 1.5rem; font-weight:600; border-radius:var(--radius);
      cursor:pointer; transition:background var(--transition), box-shadow var(--transition);
    }
    .btn-primary {
      background:var(--primary); color:var(--white); border:none;
    }
    .btn-primary:hover { background:var(--primary-dark); box-shadow:0 8px 24px rgba(0,0,0,.15); }
    .btn-secondary {
      background:transparent; color:var(--secondary);
      border:2px solid var(--secondary);
    }
    .btn-secondary:hover { background:var(--secondary); color:var(--white); }

    .small-note { font-size:.9rem; margin-top:.5rem; color:#555; }

    /*— Live List —*/
    .live-controls { display:flex; gap:1rem; margin:1rem 0; flex-wrap:wrap; }
    .live-list { list-style:none; display:grid; grid-template-columns:repeat(auto-fill,minmax(240px,1fr)); gap:var(--gap); }
    .live-item {
      background:var(--white); padding:1rem; border-radius:var(--radius);
      box-shadow:var(--shadow); display:flex; align-items:center; justify-content:space-between;
      transition:transform var(--transition), box-shadow var(--transition);
    }
    .live-item:hover { transform:translateY(-4px); box-shadow:0 8px 24px rgba(0,0,0,.15); }
    .live-item i { font-size:1.5rem; color:var(--primary); }
    .live-item .eta i { margin-right:.25rem; color:var(--accent); }

    /*— History —*/
    .history-controls { margin:1rem 0; }
    .history-controls button { margin-right:1rem; }
    .booking-list {
      list-style:none; max-height:300px; overflow-y:auto; padding-left:0;
    }
    .booking-list li {
      display:flex; align-items:center; justify-content:space-between;
      padding:.5rem 0; border-bottom:1px solid #eee;
    }
    .booking-list li span { flex:1; display:flex; align-items:center; }
    .booking-list li span i { margin-right:.5rem; color:var(--primary); }
    .badge { padding:.25rem .5rem; border-radius:8px; font-size:.8rem; }

    /*— Grid Cards —*/
    .grid-cards { display:grid; grid-template-columns:repeat(auto-fit,minmax(200px,1fr)); gap:var(--gap); }
    .card {
      background:var(--white); border-radius:var(--radius); overflow:hidden;
      position:relative; box-shadow:var(--shadow); cursor:pointer;
    }
    .card-body { padding:1rem; text-align:center; }
    .card-body p { margin-top:.5rem; font-weight:600; }
    .quick-btn {
      position:absolute; top:0; left:0; width:100%; height:100%;
      background:rgba(0,0,0,0.5); color:#fff; display:flex;
      align-items:center; justify-content:center; opacity:0;
      transition:opacity var(--transition);
    }
    .card:hover .quick-btn { opacity:1; }

    /*— Accordion —*/
    .accordion .accordion-item { margin-bottom:1rem; }
    .accordion-header {
      width:100%; background:var(--white); border:1px solid #ccc;
      border-radius:var(--radius); padding:.75rem 1rem;
      display:flex; align-items:center; justify-content:space-between;
      cursor:pointer; transition:background var(--transition);
    }
    .accordion-body { display:none; padding:1rem; border-left:4px solid var(--accent); }

    /*— Modals —*/
    .modal-overlay {
      position:fixed; top:0; left:0; width:100%; height:100%;
      background:rgba(0,0,0,0.6); display:none;
      align-items:center; justify-content:center; z-index:3000;
      backdrop-filter:blur(4px);
    }
    .modal {
      background:var(--white); border-radius:var(--radius);
      padding:1.5rem; max-width:400px; width:90%; text-align:center;
      box-shadow:0 8px 24px rgba(0,0,0,.15); position:relative;
    }
    .modal h3 { margin-bottom:1rem; display:flex; align-items:center; justify-content:center; }
    .modal h3 i { margin-right:.5rem; color:var(--accent); }
    .close-btn {
      position:absolute; top:.75rem; right:.75rem; background:none;
      border:none; font-size:1.2rem; cursor:pointer;
    }

    /*— Footer —*/
    .app-footer { text-align:center; padding:1.5rem var(--gap); background:#f0f0f0; color:#555; font-size:.9rem; }
    .app-footer i { color:var(--accent); margin-left:.5rem; }

    /*— Responsive —*/
    @media(max-width:768px){
      .header-inner { flex-wrap:wrap; text-align:center; }
      .desktop-only { display:none; }
      .hamburger { display:block; }
      .form-row { flex-direction:column; }
      .hero { flex-direction:column; text-align:center; }
      .hero-content, .hero-image { max-width:100%; }
    }
    @media(max-width:480px){
      :root{--gap:12px;}
      .app-title{font-size:1.2rem;}
      .btn-primary, .btn-secondary{width:100%;}
    }
  </style>
</head>
<body>
  <!-- Sign-In Overlay -->
  <div class="signin-overlay" id="signinOverlay">
    <div class="modal signin-modal">
      <h3><i class="fas fa-user-lock"></i> Student Sign In</h3>
      <form id="signinForm">
        <div class="form-group">
          <label for="studentId">Student ID</label>
          <input type="text" id="studentId" placeholder="8‑digit ID" maxlength="8" required>
        </div>
        <div class="form-group">
          <label for="username">Username</label>
          <input type="text" id="username" placeholder="Letters only" pattern="[A-Za-z]+" required>
        </div>
        <div class="form-group">
          <label for="password">Password</label>
          <input type="password" id="password" placeholder="At least 6 chars" minlength="6" required>
        </div>
        <button type="submit" class="btn-primary">
          <i class="fas fa-sign-in-alt"></i> Sign In
        </button>
      </form>
    </div>
  </div>

  <!-- Header & Nav -->
  <header class="app-header">
    <div class="header-inner">
      <img src="knust.png" alt="KNUST Logo" class="logo">
      <h1 class="app-title"><i class="fas fa-shuttle-van"></i> KNUST Shuttle Tracker</h1>
      <button class="hamburger" id="hamburgerBtn"><i class="fas fa-bars"></i></button>
      <nav class="header-nav desktop-only">
        <button class="nav-btn active" data-target="home"><i class="fas fa-home"></i> Home</button>
        <button class="nav-btn" data-target="live"><i class="fas fa-route"></i> Live</button>
        <button class="nav-btn" data-target="history"><i class="fas fa-history"></i> My Rides</button>
        <button class="nav-btn" data-target="faq"><i class="fas fa-question-circle"></i> FAQ</button>
        <button class="nav-btn" id="signOutBtn"><i class="fas fa-sign-out-alt"></i> Sign Out</button>
      </nav>
      <aside class="mobile-sidebar" id="mobileSidebar">
        <button class="close-sidebar" id="closeSidebar"><i class="fas fa-times"></i></button>
        <button class="nav-btn" data-target="home"><i class="fas fa-home"></i> Home</button>
        <button class="nav-btn" data-target="live"><i class="fas fa-route"></i> Live</button>
        <button class="nav-btn" data-target="history"><i class="fas fa-history"></i> My Rides</button>
        <button class="nav-btn" data-target="faq"><i class="fas fa-question-circle"></i> FAQ</button>
        <button class="nav-btn" id="mobileSignOut"><i class="fas fa-sign-out-alt"></i> Sign Out</button>
      </aside>
    </div>
  </header>

  <!-- Hero -->
  <section class="hero" id="hero">
    <div class="hero-content">
      <h2>Ride the KNUST Shuttle with Ease</h2>
      <p>Real-time tracking, simple booking, proactive notifications, and trip history at your fingertips.</p>
      <div class="hero-buttons">
        <button class="btn-primary" data-scroll="home"><i class="fas fa-map-signs"></i> Book Now</button>
        <button class="btn-secondary" data-scroll="live"><i class="fas fa-bus-alt"></i> Live Shuttles</button>
      </div>
      <ul class="hero-features">
        <li><i class="fas fa-bell"></i> Notifications 5 min before pickup</li>
        <li><i class="fas fa-ticket-alt"></i> QR code boarding</li>
        <li><i class="fas fa-chart-line"></i> Usage stats & carbon offsets</li>
      </ul>
    </div>
    <div class="hero-image">
      <img src="shuttle.jpeg" alt="Campus Shuttle">
    </div>
  </section>

  <main class="container">
    <!-- Booking -->
    <section class="section booking-section" id="home">
      <h2><i class="fas fa-paper-plane"></i> Book Your Ride</h2>
      <form id="bookingForm">
        <div class="form-row">
          <div class="form-group">
            <label for="pickup"><i class="fas fa-location-arrow"></i> Pick‑Up</label>
            <select id="pickup" class="select" required>
              <option value="">Select pick‑up</option>
              <option value="KSB">KSB</option>
              <option value="Medical Village">Medical Village</option>
              <option value="Brunei">Brunei</option>
              <option value="Casely Hayeford">Casely Hayeford</option>
              <option value="College of Science">College of Science</option>
              <option value="Commercial Area">Commercial Area</option>
            </select>
          </div>
          <div class="form-group">
            <label for="destination"><i class="fas fa-flag-checkered"></i> Destination</label>
            <select id="destination" class="select" required>
              <option value="">Select destination</option>
              <option value="KSB">KSB</option>
              <option value="Medical Village">Medical Village</option>
              <option value="Brunei">Brunei</option>
              <option value="Casely Hayeford">Casely Hayeford</option>
              <option value="College of Science">College of Science</option>
              <option value="Commercial Area">Commercial Area</option>
            </select>
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label for="date"><i class="fas fa-calendar-alt"></i> Date</label>
            <input type="date" id="date" required>
          </div>
          <div class="form-group">
            <label for="timeslot"><i class="fas fa-clock"></i> Time Slot</label>
            <select id="timeslot" class="select" required>
              <option value="">Select time</option>
              <option>6:00 AM – 7:00 AM</option>
              <option>7:00 AM – 8:00 AM</option>
              <option>8:00 AM – 9:00 AM</option>
              <option>9:00 AM –10:00 AM</option>
              <option>10:00 AM –11:00 AM</option>
              <option>12:00 PM – 1:00 PM</option>
              <option>1:00 PM – 2:00 PM</option>
              <option>3:00 PM – 4:00 PM</option>
            </select>
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label for="seats"><i class="fas fa-users"></i> Seats</label>
            <input type="number" id="seats" min="1" max="4" value="1">
          </div>
          <div class="form-group">
            <label for="notes"><i class="fas fa-comment-alt"></i> Special Notes</label>
            <input type="text" id="notes" placeholder="e.g. wheelchair assistance">
          </div>
        </div>
        <button type="submit" class="btn-primary">
          <i class="fas fa-paper-plane"></i> Confirm Booking
        </button>
      </form>
      <p class="small-note">You’ll receive a QR code—show it when boarding.</p>
    </section>

    <!-- Live Shuttles -->
    <section class="section live-section" id="live">
      <h2><i class="fas fa-route"></i> Live Shuttles</h2>
      <div id="map" style="height:300px; background:#e0e0e0; border-radius:var(--radius); margin-bottom:1rem;">
        <!-- Real map goes here -->
      </div>
      <div class="live-controls">
        <input type="text" id="routeFilter" placeholder="Filter by route…">
        <button id="pauseBtn" class="btn-secondary"><i class="fas fa-pause"></i> Pause</button>
      </div>
      <ul class="live-list"></ul>
    </section>

    <!-- My Ride History -->
    <section class="section history-section" id="history">
      <h2><i class="fas fa-history"></i> My Ride History</h2>
      <p>Total rides: <strong id="totalRides">0</strong>; Upcoming: <strong id="upcomingRides">0</strong></p>
      <div class="history-controls">
        <button class="btn-secondary" data-filter="past"><i class="fas fa-archive"></i> Past</button>
        <button class="btn-secondary" data-filter="upcoming"><i class="fas fa-clock"></i> Upcoming</button>
      </div>
      <ul id="historyList" class="booking-list">
        <!-- Filled by JS -->
      </ul>
    </section>

    <!-- Quick‑Book Popular -->
    <section class="section popular-section">
      <h2><i class="fas fa-thumbs-up"></i> Quick Book: Popular Routes</h2>
      <div class="grid-cards">
        <!-- Example Card -->
        <div class="card" data-route="KSB">
          <img src="ksb.webp" alt="KSB">
          <div class="card-body">
            <i class="fas fa-university"></i>
            <p>KSB</p>
          </div>
          <div class="quick-btn"><i class="fas fa-paper-plane"></i> Book</div>
        </div>
        <div class="card" data-route="Medical Village">
          <img src="medical.jpg" alt="Medical Village">
          <div class="card-body">
            <i class="fas fa-hospital"></i><p>Medical Village</p>
          </div>
          <div class="quick-btn"><i class="fas fa-paper-plane"></i> Book</div>
        </div>
        <div class="card" data-route="Brunei">
          <img src="brunei.jpeg" alt="Brunei">
          <div class="card-body">
            <i class="fas fa-tree"></i><p>Brunei</p>
          </div>
          <div class="quick-btn"><i class="fas fa-paper-plane"></i> Book</div>
        </div>
        <div class="card" data-route="Casely Hayeford">
          <img src="casely.jpg" alt="Casely Hayeford">
          <div class="card-body">
            <i class="fas fa-university"></i><p>Casely Hayeford</p>
          </div>
          <div class="quick-btn"><i class="fas fa-paper-plane"></i> Book</div>
        </div>
        <div class="card" data-route="College of Science">
          <img src="science.jpg" alt="College of Science">
          <div class="card-body">
            <i class="fas fa-flask"></i><p>College of Science</p>
          </div>
          <div class="quick-btn"><i class="fas fa-paper-plane"></i> Book</div>
        </div>
        <div class="card" data-route="Commercial Area">
          <img src="commercial.jpg" alt="Commercial Area">
          <div class="card-body">
            <i class="fas fa-shopping-bag"></i><p>Commercial Area</p>
          </div>
          <div class="quick-btn"><i class="fas fa-paper-plane"></i> Book</div>
        </div>
      </div>
    </section>

    <!-- FAQ -->
    <section class="section faq-section" id="faq">
      <h2><i class="fas fa-question-circle"></i> FAQs</h2>
      <div class="accordion">
        <div class="accordion-item">
          <button class="accordion-header"><i class="fas fa-chevron-down"></i> How do I cancel?</button>
          <div class="accordion-body">Tap the trash icon in “My Rides.”</div>
        </div>
        <div class="accordion-item">
          <button class="accordion-header"><i class="fas fa-chevron-down"></i> Can I book for others?</button>
          <div class="accordion-body">Yes—enter their student ID in the form.</div>
        </div>
        <div class="accordion-item">
          <button class="accordion-header"><i class="fas fa-chevron-down"></i> Weekend service?</button>
          <div class="accordion-body">Saturdays 7 AM–2 PM, no service Sundays.</div>
        </div>
        <div class="accordion-item">
          <button class="accordion-header"><i class="fas fa-chevron-down"></i> Night shuttles?</button>
          <div class="accordion-body">8 PM–11 PM under “Late Rides.”</div>
        </div>
      </div>
    </section>

    <!-- Contact -->
    <section class="section contact-section">
      <h2><i class="fas fa-envelope"></i> Contact & Support</h2>
      <p><i class="fas fa-phone-alt"></i> +233 24 123 4567</p>
      <p><i class="fas fa-envelope-open-text"></i> support@knust-shuttle.app</p>
      <div class="social-icons">
        <a href="#"><i class="fab fa-facebook-square"></i></a>
        <a href="#"><i class="fab fa-twitter-square"></i></a>
        <a href="#"><i class="fab fa-instagram-square"></i></a>
        <a href="#"><i class="fab fa-linkedin"></i></a>
      </div>
    </section>
  </main>

  <!-- Modals -->
  <div class="modal-overlay" id="confirmModal">
    <div class="modal">
      <button class="close-btn" data-close="confirmModal"><i class="fas fa-times"></i></button>
      <h3><i class="fas fa-check-circle"></i> Booking Confirmed!</h3>
      <p>Show this QR code when boarding:</p>
      <canvas id="qrCanvas"></canvas>
      <button class="btn-primary" data-close="confirmModal"><i class="fas fa-thumbs-up"></i> Done</button>
    </div>
  </div>
  <div class="modal-overlay" id="errorModal">
    <div class="modal">
      <button class="close-btn" data-close="errorModal"><i class="fas fa-times"></i></button>
      <h3><i class="fas fa-exclamation-triangle"></i> Oops!</h3>
      <p id="errorMessage">Something went wrong—please try again.</p>
      <button class="btn-primary" data-close="errorModal"><i class="fas fa-redo"></i> Retry</button>
    </div>
  </div>

  <!-- Footer -->
  <footer class="app-footer">
    <p>&copy; 2025 KNUST Shuttle Tracker — Built with <i class="fas fa-heart"></i> by a KNUST Student</p>
  </footer>

  <!-- QR Code lib (QRious) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js"></script>
  <script>
    //— Util: show/hide
    function show(el){ el.style.display='flex'; }
    function hide(el){ el.style.display='none'; }

    //— Sign‑in logic
    document.addEventListener('DOMContentLoaded',()=>{
      if(localStorage.getItem('signedIn')==='true') {
        hide(document.getElementById('signinOverlay'));
      } else {
        show(document.getElementById('signinOverlay'));
      }
    });
    document.getElementById('signinForm').addEventListener('submit',e=>{
      e.preventDefault();
      localStorage.setItem('signedIn','true');
      hide(document.getElementById('signinOverlay'));
    });
    //— Sign out
    document.getElementById('signOutBtn').onclick =
    document.getElementById('mobileSignOut').onclick = () => {
      localStorage.removeItem('signedIn');
      show(document.getElementById('signinOverlay'));
    };

    //— Sidebar toggle
    document.getElementById('hamburgerBtn').onclick = ()=>
      document.getElementById('mobileSidebar').style.left='0';
    document.getElementById('closeSidebar').onclick = ()=>
      document.getElementById('mobileSidebar').style.left='-260px';

    //— Smooth scroll nav
    document.querySelectorAll('.nav-btn[data-target]').forEach(btn=>{
      btn.onclick = ()=> {
        document.querySelectorAll('.nav-btn').forEach(b=>b.classList.remove('active'));
        btn.classList.add('active');
        document.getElementById(btn.dataset.target).scrollIntoView({behavior:'smooth'});
        hide(document.getElementById('mobileSidebar'));
      };
    });
    document.querySelectorAll('[data-scroll]').forEach(btn=>{
      btn.onclick = ()=>document.getElementById(btn.dataset.scroll).scrollIntoView({behavior:'smooth'});
    });

    //— Booking & History
    let bookings = [];
    const bookingForm = document.getElementById('bookingForm');
    const confModal = document.getElementById('confirmModal');
    const errModal  = document.getElementById('errorModal');
    const qr = new QRious({ element:document.getElementById('qrCanvas'), size:200 });

    bookingForm.onsubmit = e=>{
      e.preventDefault();
      const p = pickup.value, d=destination.value, dt=date.value, t=timeslot.value, s=seats.value;
      if(!p||!d||!dt||!t) {
        document.getElementById('errorMessage').innerText='Please fill all fields.';
        return show(errModal);
      }
      if(p===d) {
        document.getElementById('errorMessage').innerText='Pickup and destination cannot match.';
        return show(errModal);
      }
      const id=Date.now();
      bookings.push({ id,p,d,dt,t,s });
      // generate QR = JSON string of booking
      qr.value = JSON.stringify({id,p,d,dt,t,s});
      show(confModal);
      updateHistory();
      bookingForm.reset();
    };

    //— Close modals
    document.querySelectorAll('.close-btn').forEach(btn=>{
      btn.onclick = ()=> hide(document.getElementById(btn.dataset.close));
    });

    //— History rendering & filtering
    const historyList = document.getElementById('historyList');
    const totalRides    = document.getElementById('totalRides');
    const upcomingRides = document.getElementById('upcomingRides');
    function updateHistory(filter='all'){
      historyList.innerHTML='';
      const now = new Date().toISOString().split('T')[0];
      const filtered = bookings.filter(b=>{
        if(filter==='past')    return b.dt < now;
        if(filter==='upcoming')return b.dt >= now;
        return true;
      });
      filtered.forEach(b=>{
        const li = document.createElement('li');
        const when = new Date(b.dt).toLocaleDateString()+' '+b.t;
        li.innerHTML=`
          <span><i class="fas fa-qrcode"></i> ${b.p} → ${b.d} (${when})</span>
          <span><span class="badge">${b.dt<now?'Past':'Upcoming'}</span></span>
        `;
        historyList.appendChild(li);
      });
      totalRides.innerText = bookings.length;
      upcomingRides.innerText = bookings.filter(b=>b.dt>=now).length;
    }
    document.querySelectorAll('.history-controls button').forEach(btn=>{
      btn.onclick = ()=> updateHistory(btn.dataset.filter);
    });

    //— Live feed simulation
    let liveData = [
      { route:'KSB → Medical Village', eta:5 },
      { route:'Brunei → Commercial Area', eta:2 },
      { route:'Medical Village → Brunei', eta:8 },
      { route:'Commercial Area → KSB', eta:12 },
      { route:'Casely Hayeford → College of Science', eta:7 },
      { route:'College of Science → KSB', eta:4 },
    ];
    const liveList = document.querySelector('.live-list');
    function renderLive(){
      liveList.innerHTML='';
      liveData.forEach(i=>{
        const li = document.createElement('li');
        li.className='live-item';
        li.innerHTML=`
          <i class="fas fa-bus"></i>
          <span class="route">${i.route}</span>
          <span class="eta"><i class="fas fa-hourglass-half"></i> ${i.eta} min</span>
        `;
        liveList.appendChild(li);
      });
    }
    let liveInterval = null;
    function startLive(){
      renderLive();
      liveInterval = setInterval(()=>{
        liveData = liveData.map(i=>{
          let e=i.eta-1; if(e<=0) e=Math.floor(Math.random()*10)+1;
          return {...i,eta:e};
        });
        renderLive();
      },10000);
    }
    document.getElementById('pauseBtn').onclick = ()=>{
      if(liveInterval){
        clearInterval(liveInterval);
        liveInterval=null;
        pauseBtn.innerHTML='<i class="fas fa-play"></i> Resume';
      } else {
        startLive();
        pauseBtn.innerHTML='<i class="fas fa-pause"></i> Pause';
      }
    };
    document.getElementById('routeFilter').onkeyup = ()=>{
      const q=routeFilter.value.toLowerCase();
      document.querySelectorAll('.live-item').forEach(li=>{
        li.style.display = li.querySelector('.route').innerText.toLowerCase().includes(q)?'flex':'none';
      });
    };

    //— Quick‑book from cards
    document.querySelectorAll('.card').forEach(card=>{
      card.onclick = ()=>{
        pickup.value = card.dataset.route;
        document.getElementById('home').scrollIntoView({behavior:'smooth'});
      };
    });

    //— Accordion
    document.querySelectorAll('.accordion-header').forEach(h=>{
      h.onclick = ()=>{
        const body = h.nextElementSibling;
        body.style.display = body.style.display==='block'?'none':'block';
        h.querySelector('i').classList.toggle('fa-rotate-180');
      };
    });

    //— Init all
    document.addEventListener('DOMContentLoaded',()=>{
      updateHistory();
      startLive();
    });
  </script>
</body>
</html>
